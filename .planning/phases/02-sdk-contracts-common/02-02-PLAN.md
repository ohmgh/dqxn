---
phase: 02-sdk-contracts-common
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - android/sdk/contracts/build.gradle.kts
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetSpec.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetRenderer.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetData.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetStyle.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetContext.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetDefaults.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetAction.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/SettingsAwareSizer.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/entitlement/Gated.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/entitlement/EntitlementManager.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/entitlement/Entitlements.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardWidget.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardDataProvider.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardSnapshot.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataSnapshot.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataProvider.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataProviderSpec.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/ProviderPriority.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/ActionableProvider.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataProviderInterceptor.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataSchema.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataTypes.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/UnitSnapshot.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/fault/ProviderFault.kt
autonomous: true
requirements: [F2.1, F2.2, F2.4, F2.5, F2.10, F2.11, F2.12, F2.16, F2.19, F2.20, F3.1, F3.2, F3.6, F3.8, F8.1, F8.3]

must_haves:
  truths:
    - "WidgetRenderer extends WidgetSpec + Gated with @Composable Render() that reads data from LocalWidgetData"
    - "WidgetData uses KClass-keyed ImmutableMap for type-safe multi-slot snapshot access"
    - "DataProvider<T : DataSnapshot> is a generic interface enforcing compile-time type safety"
    - "Gated.isAccessible() implements OR-logic: null/empty = free, any matching entitlement grants access"
    - "All KSP annotations (@DashboardWidget, @DashboardDataProvider, @DashboardSnapshot) defined with SOURCE retention"
    - "ProviderFault sealed interface in main source set (not testFixtures) with 7 variants"
    - "compileOnly(compose.runtime) provides annotations without triggering Compose compiler"
  artifacts:
    - path: "android/sdk/contracts/build.gradle.kts"
      provides: "Module build configuration with compileOnly compose-runtime, testFixtures, serialization"
      contains: "java-test-fixtures"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetRenderer.kt"
      provides: "Core widget rendering contract"
      contains: "interface WidgetRenderer"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetData.kt"
      provides: "KClass-keyed multi-slot widget data"
      contains: "data class WidgetData"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataProvider.kt"
      provides: "Generic data provider contract"
      contains: "interface DataProvider<T : DataSnapshot>"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/entitlement/Gated.kt"
      provides: "Entitlement gating interface with OR-logic"
      contains: "interface Gated"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/fault/ProviderFault.kt"
      provides: "Chaos injection fault types"
      contains: "sealed interface ProviderFault"
  key_links:
    - from: "WidgetRenderer.kt"
      to: "WidgetSpec.kt + Gated.kt"
      via: "interface inheritance"
      pattern: "interface WidgetRenderer : WidgetSpec, Gated"
    - from: "DataProvider.kt"
      to: "DataProviderSpec.kt + Gated.kt + DataSnapshot.kt"
      via: "generic interface + inheritance"
      pattern: "interface DataProvider<T : DataSnapshot> : DataProviderSpec"
    - from: "WidgetData.kt"
      to: "DataSnapshot.kt"
      via: "KClass key + ImmutableMap"
      pattern: "ImmutableMap<KClass<out DataSnapshot>, DataSnapshot>"
    - from: "build.gradle.kts"
      to: ":sdk:common"
      via: "api project dependency"
      pattern: "api\\(project\\(\":sdk:common\"\\)\\)"
---

<objective>
Define the `:sdk:contracts` build configuration and implement all widget, provider, entitlement, annotation, and fault types. This is the core type surface that every pack and feature module depends on.

Purpose: Establish the complete widget-provider contract and entitlement gating foundation. All downstream consumers compile against these types.
Output: Compiling `:sdk:contracts` with widget, provider, entitlement, annotation, and fault types in main source set.
</objective>

<execution_context>
@/Users/ohm/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ohm/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-sdk-contracts-common/02-RESEARCH.md
@.planning/migration/phase-02.md
@.planning/phases/02-sdk-contracts-common/02-01-SUMMARY.md
@android/sdk/contracts/build.gradle.kts
@android/gradle/libs.versions.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure sdk:contracts build and implement widget + entitlement + annotation types</name>
  <files>
    android/sdk/contracts/build.gradle.kts
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetSpec.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetRenderer.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetData.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetStyle.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetContext.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetDefaults.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/WidgetAction.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/widget/SettingsAwareSizer.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/entitlement/Gated.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/entitlement/EntitlementManager.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/entitlement/Entitlements.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardWidget.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardDataProvider.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardSnapshot.kt
  </files>
  <action>
    **build.gradle.kts — REPLACE entire file:**
    ```kotlin
    plugins {
      id("dqxn.android.library")
      id("dqxn.android.test")
      id("java-test-fixtures")
      alias(libs.plugins.kotlin.serialization)
    }

    android { namespace = "app.dqxn.android.sdk.contracts" }

    dependencies {
      api(project(":sdk:common"))

      compileOnly(libs.compose.runtime) // @Composable, @Immutable annotations only — no Compose compiler
      compileOnly(libs.compose.ui)      // Modifier type reference in WidgetRenderer.Render() — no Compose compiler
      implementation(libs.kotlinx.collections.immutable)
      implementation(libs.kotlinx.coroutines.core)
      implementation(libs.kotlinx.serialization.json)

      // testFixtures dependencies (separate scope — not inherited from main)
      testFixturesImplementation(project(":sdk:common"))
      testFixturesImplementation(libs.compose.runtime)
      testFixturesImplementation(libs.kotlinx.collections.immutable)
      testFixturesImplementation(libs.kotlinx.coroutines.core)
      testFixturesImplementation(libs.kotlinx.coroutines.test)
      testFixturesImplementation(platform(libs.junit.bom))
      testFixturesImplementation(libs.junit.jupiter.api)
      testFixturesImplementation(libs.junit.vintage.engine)
      testFixturesImplementation(libs.truth)
      testFixturesImplementation(libs.jqwik)
      testFixturesImplementation(libs.turbine)
      testFixturesImplementation(libs.robolectric)
    }
    ```

    **CRITICAL: compose-runtime version resolution.** The catalog entry `compose-runtime` has no version (expects BOM). For `compileOnly`, try it as-is first. If it fails to resolve, add a versioned alias to libs.versions.toml: `compose-runtime-standalone = { group = "androidx.compose.runtime", name = "runtime", version = "1.8.0" }` and use that instead. Alternatively, try `compileOnly(platform(libs.compose.bom))` then `compileOnly(libs.compose.runtime)`. Verify with `./gradlew :sdk:contracts:dependencies --configuration debugCompileClasspath --console=plain` and check that `androidx.compose.runtime:runtime` appears.

    **WidgetSpec.kt (package: app.dqxn.android.sdk.contracts.widget):**
    ```kotlin
    interface WidgetSpec {
      val typeId: String
      val displayName: String
      val description: String  // F2.20
      val compatibleSnapshots: Set<KClass<out DataSnapshot>>
      val settingsSchema: List<SettingDefinition<*>>
      val aspectRatio: Float?  // F2.16 — null = freeform
      val supportsTap: Boolean
      val priority: Int
      fun getDefaults(context: WidgetContext): WidgetDefaults
    }
    ```
    Note: `settingsSchema` references `SettingDefinition` which is created in Plan 03. Use a forward reference — Kotlin allows this within the same compilation unit. If compilation order becomes an issue, use `List<Any>` temporarily and fix in Plan 03. BUT since Plans 02 and 03 run sequentially (same wave, shared build.gradle.kts), Plan 03 will fix any forward references before final compilation.

    **WidgetRenderer.kt:**
    ```kotlin
    interface WidgetRenderer : WidgetSpec, Gated {
      @Composable
      fun Render(
        isEditMode: Boolean,
        style: WidgetStyle,
        settings: ImmutableMap<String, Any>,
        modifier: Modifier,
      )
      fun accessibilityDescription(data: WidgetData): String  // F2.19
      fun onTap(widgetId: String, settings: ImmutableMap<String, Any>): Boolean
    }
    ```
    Imports: `@Composable` from `androidx.compose.runtime`, `@Immutable` from same. `Modifier` from `androidx.compose.ui` — but wait, `:sdk:contracts` only has `compileOnly(compose.runtime)`, not `compose.ui`. `Modifier` is in `compose-ui`. So either: (a) add `compileOnly(libs.compose.ui)` or (b) accept that `Modifier` is a `compose-ui` type. Per research, add `compileOnly(libs.compose.ui)` to the build.gradle.kts — same pattern as compose-runtime, annotation-only usage.

    **WidgetData.kt:**
    ```kotlin
    @Immutable
    data class WidgetData(
      val snapshots: ImmutableMap<KClass<out DataSnapshot>, DataSnapshot>,
      val timestamp: Long,
    ) {
      inline fun <reified T : DataSnapshot> snapshot(): T? = snapshots[T::class] as? T
      fun withSlot(type: KClass<out DataSnapshot>, snapshot: DataSnapshot): WidgetData =
        WidgetData(snapshots.put(type, snapshot), snapshot.timestamp)
      fun hasData(): Boolean = snapshots.isNotEmpty()
      companion object {
        val Empty: WidgetData = WidgetData(persistentMapOf(), 0L)
        val Unavailable: WidgetData = WidgetData(persistentMapOf(), -1L)
      }
    }
    ```

    **WidgetStyle.kt:**
    - `@Serializable @Immutable data class WidgetStyle(backgroundStyle: BackgroundStyle, opacity: Float, showBorder: Boolean, hasGlowEffect: Boolean, cornerRadiusPercent: Int, rimSizePercent: Int, zLayer: Int)`
    - `@Serializable enum class BackgroundStyle { NONE, SOLID }`
    - Default companion: `val Default = WidgetStyle(BackgroundStyle.NONE, 1.0f, false, false, 25, 0, 0)`

    **WidgetContext.kt:**
    - `@Immutable data class WidgetContext(val timezone: ZoneId, val locale: Locale, val region: String)`
    - `companion object { val DEFAULT = WidgetContext(ZoneId.of("UTC"), Locale.US, "US") }`

    **WidgetDefaults.kt:**
    - `@Immutable data class WidgetDefaults(val widthUnits: Int, val heightUnits: Int, val aspectRatio: Float?, val settings: Map<String, Any?>)`

    **WidgetAction.kt:**
    - `sealed interface WidgetAction { data class Tap(val widgetId: String) : WidgetAction; data class MediaControl(val command: String) : WidgetAction; data class TripReset(val tripId: String) : WidgetAction; data class Custom(val actionId: String, val params: Map<String, Any?>) : WidgetAction }`

    **SettingsAwareSizer.kt:**
    - `interface SettingsAwareSizer { fun computeSize(settings: Map<String, Any?>): WidgetDefaults }`

    **Gated.kt (package: app.dqxn.android.sdk.contracts.entitlement):**
    - `interface Gated { val requiredAnyEntitlement: Set<String>? }`
    - Extension: `fun Gated.isAccessible(hasEntitlement: (String) -> Boolean): Boolean { val required = requiredAnyEntitlement; if (required.isNullOrEmpty()) return true; return required.any { hasEntitlement(it) } }`

    **EntitlementManager.kt:**
    - `interface EntitlementManager { fun hasEntitlement(id: String): Boolean; fun getActiveEntitlements(): Set<String>; val entitlementChanges: Flow<Set<String>> }`
    - Minimal V1 — defer `purchaseProduct()`/`restorePurchases()` per phase-02.md.

    **Entitlements.kt:**
    - `object Entitlements { const val FREE = "free"; const val THEMES = "themes"; const val PLUS = "plus" }`

    **DashboardWidget.kt (package: app.dqxn.android.sdk.contracts.annotation):**
    - `@Retention(AnnotationRetention.SOURCE) @Target(AnnotationTarget.CLASS) annotation class DashboardWidget(val typeId: String, val displayName: String, val icon: String = "")`

    **DashboardDataProvider.kt:**
    - `@Retention(AnnotationRetention.SOURCE) @Target(AnnotationTarget.CLASS) annotation class DashboardDataProvider(val localId: String, val displayName: String, val description: String = "")`

    **DashboardSnapshot.kt:**
    - `@Retention(AnnotationRetention.SOURCE) @Target(AnnotationTarget.CLASS) annotation class DashboardSnapshot(val dataType: String)`
  </action>
  <verify>
    <automated>cd /Users/ohm/Workspace/dqxn/android && ./gradlew :sdk:contracts:compileDebugKotlin --console=plain 2>&1 | tail -10</automated>
    <manual>Verify compose-runtime resolved as compileOnly (check dependencies output)</manual>
  </verify>
  <done>`:sdk:contracts` compiles with widget types (WidgetRenderer, WidgetSpec, WidgetData, WidgetStyle, WidgetContext, WidgetDefaults, WidgetAction, SettingsAwareSizer), entitlement types (Gated, EntitlementManager, Entitlements), and all 3 KSP annotations. build.gradle.kts configured with java-test-fixtures, kotlin-serialization, compileOnly compose-runtime.</done>
</task>

<task type="auto">
  <name>Task 2: Implement provider, fault, and data schema types</name>
  <files>
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataSnapshot.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataProvider.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataProviderSpec.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/ProviderPriority.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/ActionableProvider.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataProviderInterceptor.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataSchema.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/DataTypes.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/provider/UnitSnapshot.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/fault/ProviderFault.kt
  </files>
  <action>
    **DataSnapshot.kt (package: app.dqxn.android.sdk.contracts.provider):**
    - `@Immutable interface DataSnapshot { val timestamp: Long }`
    - Non-sealed — packs define concrete `@DashboardSnapshot` subtypes.

    **DataProviderSpec.kt:**
    ```kotlin
    interface DataProviderSpec : Gated {
      val sourceId: String
      val displayName: String
      val description: String
      val dataType: String
      val priority: ProviderPriority
    }
    ```

    **ProviderPriority.kt:**
    - `enum class ProviderPriority { HARDWARE, DEVICE_SENSOR, NETWORK, SIMULATED }`

    **DataProvider.kt:**
    ```kotlin
    interface DataProvider<T : DataSnapshot> : DataProviderSpec {
      val snapshotType: KClass<T>
      fun provideState(): Flow<T>
      val schema: DataSchema
      val setupSchema: List<SetupPageDefinition>
      val subscriberTimeout: Duration  // default 5s in implementations
      val firstEmissionTimeout: Duration  // default 5s in implementations
      val isAvailable: Boolean
      val connectionState: Flow<Boolean>
      val connectionErrorDescription: Flow<String?>
    }
    ```
    Note: `SetupPageDefinition` is defined in Plan 03. This creates a forward reference. Since Plans 02 and 03 are sequential (02 compiles first attempt may fail if SetupPageDefinition doesn't exist yet), handle this by:
    1. Trying to compile — if `SetupPageDefinition` unresolved, leave `setupSchema` temporarily typed as `List<Any>` with a TODO comment
    2. Plan 03 will fix the type once `SetupPageDefinition` exists

    **ACTUALLY**: Plans 02 and 03 run in different waves (02=wave 2, 03=wave 3). So Plan 02 must compile standalone. Use `List<Any>` as temporary type for `setupSchema` and `settingsSchema` on `WidgetSpec`, with `// TODO: Replace with SetupPageDefinition/SettingDefinition in Plan 03` comments. Plan 03 will fix these.

    **BETTER APPROACH**: Define empty marker interfaces for `SetupPageDefinition` and `SettingDefinition` in their respective packages within this plan, just enough for compilation. Plan 03 will flesh them out. This avoids `Any` types and maintains type safety.

    Create stub files:
    - `android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupPageDefinition.kt` — just `data class SetupPageDefinition(val id: String, val title: String, val description: String? = null, val definitions: List<SetupDefinition>)` + `sealed interface SetupDefinition` (empty body, fleshed out in Plan 03)
    - `android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/SettingDefinition.kt` — just `sealed interface SettingDefinition<T>` (empty body, fleshed out in Plan 03)

    **ActionableProvider.kt:**
    - `interface ActionableProvider<T : DataSnapshot> : DataProvider<T> { fun onAction(action: WidgetAction) }`

    **DataProviderInterceptor.kt:**
    - `interface DataProviderInterceptor { fun <T : DataSnapshot> intercept(provider: DataProvider<T>, upstream: Flow<T>): Flow<T> }`

    **DataSchema.kt:**
    - `@Immutable data class DataSchema(val fields: List<DataFieldSpec>, val stalenessThresholdMs: Long)`
    - `@Immutable data class DataFieldSpec(val name: String, val typeId: String, val unit: String? = null, val displayName: String? = null)`

    **DataTypes.kt:**
    - `object DataTypes { const val SPEED = "SPEED"; const val TIME = "TIME"; const val ORIENTATION = "ORIENTATION"; const val BATTERY = "BATTERY"; const val SOLAR = "SOLAR"; const val AMBIENT_LIGHT = "AMBIENT_LIGHT"; const val ACCELERATION = "ACCELERATION"; const val SPEED_LIMIT = "SPEED_LIMIT"; const val MEDIA_SESSION = "MEDIA_SESSION"; const val TRIP = "TRIP"; const val ALTITUDE = "ALTITUDE"; const val WEATHER = "WEATHER" }`

    **UnitSnapshot.kt:**
    - `@Immutable data class UnitSnapshot(override val timestamp: Long) : DataSnapshot` — sentinel for action-only providers.

    **ProviderFault.kt (package: app.dqxn.android.sdk.contracts.fault):**
    - `sealed interface ProviderFault`
    - 7 variants: `data object Kill`, `data class Delay(val delayMs: Long)`, `data class Error(val exception: Exception)`, `data class ErrorOnNext(val exception: Exception)`, `data class Corrupt(val transform: (DataSnapshot) -> DataSnapshot)`, `data class Flap(val onMillis: Long, val offMillis: Long)`, `data object Stall`
    - MUST be in main source set (not testFixtures) — consumed by `ChaosProviderInterceptor` at debug runtime.
  </action>
  <verify>
    <automated>cd /Users/ohm/Workspace/dqxn/android && ./gradlew :sdk:contracts:compileDebugKotlin --console=plain 2>&1 | tail -10</automated>
    <manual>Verify all provider types compile, ProviderFault is in main source set</manual>
  </verify>
  <done>All provider types compile: DataProvider<T> generic contract, DataProviderSpec, DataSnapshot interface, ActionableProvider, DataProviderInterceptor, DataSchema with stalenessThresholdMs, DataTypes constants, UnitSnapshot sentinel, ProviderFault 7 variants in main source. Stub SetupPageDefinition and SettingDefinition created for compilation — Plan 03 fleshes these out.</done>
</task>

</tasks>

<verification>
1. `./gradlew :sdk:contracts:compileDebugKotlin --console=plain` — all types compile
2. `./gradlew :sdk:contracts:dependencies --configuration debugCompileClasspath --console=plain | grep compose.runtime` — compileOnly resolution verified
3. `./gradlew spotlessCheck --console=plain` — formatting passes
4. Verify ProviderFault.kt is under `src/main/kotlin/` not `src/testFixtures/`
</verification>

<success_criteria>
- `:sdk:contracts` compiles with compileOnly compose-runtime resolving
- java-test-fixtures plugin applied
- Widget types: WidgetRenderer, WidgetSpec, WidgetData (KClass-keyed), WidgetStyle (@Serializable), WidgetContext, WidgetDefaults, WidgetAction, SettingsAwareSizer
- Provider types: DataProvider<T>, DataProviderSpec, DataSnapshot, ActionableProvider, DataProviderInterceptor, DataSchema, DataTypes, UnitSnapshot
- Entitlement types: Gated + isAccessible extension, EntitlementManager, Entitlements
- Annotations: @DashboardWidget, @DashboardDataProvider, @DashboardSnapshot (all SOURCE retention)
- Fault types: ProviderFault (7 variants, main source set)
- api(project(":sdk:common")) exposes AppResult, AppError, ConnectionStateMachine transitively
</success_criteria>

<output>
After completion, create `.planning/phases/02-sdk-contracts-common/02-02-SUMMARY.md`
</output>
