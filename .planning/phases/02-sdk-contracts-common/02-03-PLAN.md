---
phase: 02-sdk-contracts-common
plan: 03
type: execute
wave: 3
depends_on: ["02-02"]
files_modified:
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupPageDefinition.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupDefinition.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupEvaluator.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/ServiceType.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/VerificationStrategy.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/SettingDefinition.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/SettingsEnums.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/InfoCardSettings.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/InAppNotification.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/NotificationPriority.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/AlertProfile.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/AlertEmitter.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/AlertResult.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/NotificationAction.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/status/WidgetRenderState.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/status/WidgetIssue.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/status/WidgetStatusCache.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/theme/ThemeSpec.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/theme/ThemeProvider.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/theme/AutoSwitchMode.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/pack/DashboardPackManifest.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/registry/WidgetRegistry.kt
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/registry/DataProviderRegistry.kt
autonomous: true
requirements: [F3.3, F3.4, F3.5, F9.1, F9.2, F9.3, F9.4]

must_haves:
  truths:
    - "SetupDefinition sealed interface has 7 subtypes in 3 categories: requirement (RuntimePermission, SystemServiceToggle, SystemService, DeviceScan), display (Instruction, Info), input (Setting wrapper)"
    - "SettingDefinition sealed interface has 12 subtypes all implementing Gated with three-layer visibility (hidden, visibleWhen, requiredAnyEntitlement)"
    - "InAppNotification sealed interface has Toast and Banner subtypes with priority and alert profile"
    - "WidgetRenderState sealed interface has 8 overlay state variants (Ready, SetupRequired, ConnectionError, Disconnected, EntitlementRevoked, ProviderMissing, DataTimeout, DataStale)"
    - "ThemeSpec metadata interface extends Gated — no Compose types"
    - "WidgetRegistry and DataProviderRegistry interfaces defined for Phase 7 implementation"
  artifacts:
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupDefinition.kt"
      provides: "7-type setup schema with 3 categories"
      contains: "sealed interface SetupDefinition"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/SettingDefinition.kt"
      provides: "12-type settings schema implementing Gated"
      contains: "sealed interface SettingDefinition<T>"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/InAppNotification.kt"
      provides: "Notification types with priority and alert profile"
      contains: "sealed interface InAppNotification"
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/status/WidgetRenderState.kt"
      provides: "Widget overlay state sealed hierarchy"
      contains: "sealed interface WidgetRenderState"
  key_links:
    - from: "SetupDefinition.kt"
      to: "SettingDefinition.kt + Gated.kt"
      via: "Setting wrapper delegates to SettingDefinition, all implement Gated"
      pattern: "data class Setting.*SettingDefinition"
    - from: "DataProvider.kt"
      to: "SetupPageDefinition.kt"
      via: "setupSchema property type"
      pattern: "val setupSchema: List<SetupPageDefinition>"
    - from: "WidgetSpec.kt"
      to: "SettingDefinition.kt"
      via: "settingsSchema property type"
      pattern: "val settingsSchema: List<SettingDefinition"
---

<objective>
Complete the `:sdk:contracts` type surface with setup/settings/notification/status/theme/pack/registry types. Replaces Plan 02's stub SetupPageDefinition and SettingDefinition with full implementations.

Purpose: These types are consumed by widget settings UI (Phase 10), setup wizard (Phase 10), notification coordinator (Phase 7), and status overlays (Phase 7). The complete type surface means no further modifications to `:sdk:contracts` in downstream phases.
Output: All `:sdk:contracts` main source types defined and compiling.
</objective>

<execution_context>
@/Users/ohm/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ohm/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-sdk-contracts-common/02-RESEARCH.md
@.planning/migration/phase-02.md
@.planning/migration/replication-advisory.md
@.planning/phases/02-sdk-contracts-common/02-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement setup + settings types (SetupDefinition 7 subtypes, SettingDefinition 12 subtypes, enums)</name>
  <files>
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupPageDefinition.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupDefinition.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/SetupEvaluator.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/ServiceType.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/setup/VerificationStrategy.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/SettingDefinition.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/SettingsEnums.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/settings/InfoCardSettings.kt
  </files>
  <action>
    **IMPORTANT: Replication Advisory §7 compliance.** Before implementing, the executor MUST read `.planning/migration/replication-advisory.md` Section 7 for exact semantics of three-layer visibility, Setting wrapper double-gating, visibleWhen null-means-visible convention, evaluator two-variant semantics, and type-prefixed serialization format.

    **Replace SetupPageDefinition.kt stub** from Plan 02 with full implementation:
    ```kotlin
    @Immutable
    data class SetupPageDefinition(
      val id: String,
      val title: String,
      val description: String? = null,
      val definitions: List<SetupDefinition>,
    )
    ```

    **SetupDefinition.kt — replace stub with full 7-subtype sealed interface:**
    All subtypes implement `Gated`. All have `id: String`, `label: String`, `description: String?`, `iconName: String?`, `hidden: Boolean`, `visibleWhen: ((Map<String, Any?>) -> Boolean)?`, `requiredAnyEntitlement: Set<String>?`.

    **Requirement subtypes:**
    1. `data class RuntimePermission(... val permissions: List<String>, val minSdk: Int = 0)` — minSdk gating: if `minSdk > Build.VERSION.SDK_INT`, evaluator skips it
    2. `data class SystemServiceToggle(... val settingsAction: String, val serviceType: ServiceType)` — NO `checkEnabled: (Context) -> Boolean`. Replaced with declarative `ServiceType` enum.
    3. `data class SystemService(... val serviceType: ServiceType)`
    4. `data class DeviceScan(... val handlerId: String, val deviceNamePattern: String? = null, val serviceUuids: List<String> = emptyList(), val maxDevices: Int = 1)`

    **Display subtypes:**
    5. `data class Instruction(... val stepNumber: Int, val action: InstructionAction? = null, val verificationStrategy: VerificationStrategy? = null, val verificationOptional: Boolean = true, val alternativeResolution: String? = null)`
    6. `data class Info(... val style: InfoStyle = InfoStyle.INFO)`

    **Input wrapper:**
    7. `data class Setting(val definition: SettingDefinition<*>, override val id: String = definition.key, override val label: String = definition.label, ...)`
    The Setting wrapper delegates `id`, `label`, `visibleWhen`, `requiredAnyEntitlement`, `hidden`, `default` to the wrapped definition. Its own `visibleWhen` is checked FIRST, then the inner definition's `visibleWhen` — intentional double-gating per replication advisory.

    Extension functions:
    - `fun SettingDefinition<*>.asSetup(): SetupDefinition.Setting`
    - `val SetupDefinition.isRequirement: Boolean` (RuntimePermission, SystemServiceToggle, SystemService, DeviceScan)
    - `val SetupDefinition.isDisplay: Boolean` (Instruction, Info)
    - `val SetupDefinition.isInput: Boolean` (Setting)
    - `fun SetupDefinition.getDefaultValue(): Any?`

    **ServiceType.kt:**
    - `enum class ServiceType { BLUETOOTH, LOCATION, WIFI }`

    **VerificationStrategy.kt:**
    - `interface VerificationStrategy { suspend fun verify(): VerificationResult }`
    - `sealed interface VerificationResult { data object Verified : VerificationResult; data class Failed(val message: String) : VerificationResult; data object Skipped : VerificationResult }`
    Interface only — implementations have Context dependency, deferred to Phase 10.

    **InstructionAction sealed interface:**
    - `sealed interface InstructionAction { data class OpenSystemSettings(val settingsAction: String) : InstructionAction; data class OpenUrl(val url: String) : InstructionAction; data class LaunchApp(val packageName: String) : InstructionAction }`

    **InfoStyle enum:**
    - `enum class InfoStyle { INFO, WARNING, SUCCESS, ERROR }`

    **SetupEvaluator.kt:**
    - `interface SetupEvaluator { fun evaluate(schema: List<SetupPageDefinition>): List<SetupResult> }`
    - `data class SetupResult(val definitionId: String, val satisfied: Boolean)`
    Interface only in Phase 2 — two-variant semantics (`evaluate()` real-time + `evaluateWithPersistence()` checking paired device store) documented via KDoc but implementations deferred to Phase 7/10.

    **SettingDefinition.kt — replace stub with full 12-subtype sealed interface:**
    All implement `Gated`. All carry: `key: String`, `label: String`, `description: String?`, `default: T`, `visibleWhen: ((Map<String, Any?>) -> Boolean)?`, `groupId: String?`, `hidden: Boolean`, `requiredAnyEntitlement: Set<String>?`.

    12 subtypes:
    1. `BooleanSetting` (T=Boolean)
    2. `IntSetting` (T=Int, `min: Int`, `max: Int`, `presets: List<Int>? = null`, `presetsWhen: ((Map<String, Any?>) -> List<Int>?)? = null`). Add `fun getEffectivePresets(currentSettings: Map<String, Any?>): List<Int>?` that checks `presetsWhen` first, falls back to `presets`.
    3. `FloatSetting` (T=Float, `min: Float`, `max: Float`, `step: Float? = null`)
    4. `StringSetting` (T=String, `placeholder: String? = null`, `maxLength: Int? = null`)
    5. `EnumSetting<E : Enum<E>>` (T=E, `options: List<E>`, `optionLabels: Map<E, String>? = null`). No `optionPreviews` — stripped per phase-02.md.
    6. `TimezoneSetting` (T=String?, null = system default, "SYSTEM" sentinel)
    7. `DateFormatSetting` (T=DateFormatOption)
    8. `UriSetting` (T=String?)
    9. `AppPickerSetting` (T=String?, `suggestedPackages: List<String> = emptyList()`)
    10. `SoundPickerSetting` (T=String?, `soundType: SoundType = SoundType.NOTIFICATION`)
    11. `InstructionSetting` (T=Unit, display-only parallel to SetupDefinition.Instruction)
    12. `InfoSetting` (T=Unit, display-only parallel to SetupDefinition.Info)

    **SettingsEnums.kt — all settings-related enums in one file:**
    - `enum class SizeOption { SMALL, MEDIUM, LARGE, EXTRA_LARGE }` + `fun SizeOption.toMultiplier(): Float` (0.75f, 1.0f, 1.25f, 1.5f)
    - `enum class TimezonePosition { TOP, BOTTOM, HIDDEN }`
    - `enum class DateLayoutOption { SIMPLE, STACK, GRID }`
    - `enum class DateFormatOption` — common date format patterns
    - `enum class InfoCardLayoutMode { STANDARD, COMPACT, WIDE }`
    - `enum class SoundType { NOTIFICATION, ALARM, RINGTONE }`
    - `enum class InfoStyle { INFO, WARNING, SUCCESS, ERROR }` (if not already in setup package, or import from there)
    - `sealed interface InstructionAction` (if not already in setup, or consolidate)

    **InfoCardSettings.kt:**
    - Helper factory methods: `fun infoCardSettingsSchema(): List<SettingDefinition<*>>` — returns the standard InfoCard settings schema (layout mode, size option) used by 5+ widgets. Pure factory, no Compose.

    After all files are in place, fix any forward-reference stubs from Plan 02. The `WidgetSpec.settingsSchema` should now reference the real `SettingDefinition<*>`, and `DataProvider.setupSchema` should reference the real `SetupPageDefinition`. If Plan 02 left stub types, update the imports.
  </action>
  <verify>
    <automated>cd /Users/ohm/Workspace/dqxn/android && ./gradlew :sdk:contracts:compileDebugKotlin --console=plain 2>&1 | tail -10</automated>
    <manual>Verify all 7 SetupDefinition subtypes and all 12 SettingDefinition subtypes compile</manual>
  </verify>
  <done>Setup types: SetupPageDefinition, SetupDefinition (7 subtypes in 3 categories), SetupEvaluator interface, ServiceType, VerificationStrategy. Settings types: SettingDefinition (12 subtypes all implementing Gated), settings enums (SizeOption, TimezonePosition, DateLayoutOption, DateFormatOption, InfoCardLayoutMode, SoundType), InfoCardSettings helper. Three-layer visibility semantics preserved from replication advisory.</done>
</task>

<task type="auto">
  <name>Task 2: Implement notification, status, theme, pack, and registry types</name>
  <files>
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/InAppNotification.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/NotificationPriority.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/AlertProfile.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/AlertEmitter.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/AlertResult.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/notification/NotificationAction.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/status/WidgetRenderState.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/status/WidgetIssue.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/status/WidgetStatusCache.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/theme/ThemeSpec.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/theme/ThemeProvider.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/theme/AutoSwitchMode.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/pack/DashboardPackManifest.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/registry/WidgetRegistry.kt
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/registry/DataProviderRegistry.kt
  </files>
  <action>
    **InAppNotification.kt (package: app.dqxn.android.sdk.contracts.notification):**
    ```kotlin
    sealed interface InAppNotification {
      val id: String
      val priority: NotificationPriority
      val timestamp: Long
      val alertProfile: AlertProfile?

      data class Toast(
        override val id: String,
        override val priority: NotificationPriority,
        override val timestamp: Long,
        override val alertProfile: AlertProfile? = null,
        val message: String,
        val durationMs: Long = 4_000L,
      ) : InAppNotification

      data class Banner(
        override val id: String,
        override val priority: NotificationPriority,
        override val timestamp: Long,
        override val alertProfile: AlertProfile? = null,
        val title: String,
        val message: String,
        val actions: ImmutableList<NotificationAction>,
        val dismissible: Boolean,
      ) : InAppNotification
    }
    ```

    **NotificationPriority.kt:**
    - `enum class NotificationPriority { CRITICAL, HIGH, NORMAL, LOW }`

    **AlertProfile.kt:**
    - `@Immutable data class AlertProfile(val mode: AlertMode, val soundUri: String? = null, val ttsMessage: String? = null, val vibrationPattern: ImmutableList<Long>? = null)`
    - `enum class AlertMode { SILENT, VIBRATE, SOUND }`
    - F9.2: AlertMode for per-alert selection. F9.3: ttsMessage for TTS. F9.4: soundUri for custom sounds.

    **AlertEmitter.kt:**
    - `interface AlertEmitter { suspend fun fire(profile: AlertProfile): AlertResult }`
    - Implementation in Phase 7 (`AlertSoundManager`, `@Singleton`).

    **AlertResult.kt:**
    - `enum class AlertResult { PLAYED, SILENCED, FOCUS_DENIED, UNAVAILABLE }`

    **NotificationAction.kt:**
    - `@Immutable data class NotificationAction(val label: String, val actionId: String)`

    **WidgetRenderState.kt (package: app.dqxn.android.sdk.contracts.status):**
    ```kotlin
    sealed interface WidgetRenderState {
      data object Ready : WidgetRenderState
      data class SetupRequired(
        val requirementType: String? = null,  // "permission", "hardware", "onboarding", null
        val iconName: String? = null,
        val message: String? = null,
      ) : WidgetRenderState
      data class ConnectionError(
        val message: String? = null,
        val iconName: String? = null,
      ) : WidgetRenderState
      data object Disconnected : WidgetRenderState
      data class EntitlementRevoked(
        val upgradeEntitlement: String,
        val iconName: String? = null,
      ) : WidgetRenderState
      data object ProviderMissing : WidgetRenderState
      data class DataTimeout(
        val message: String? = null,
      ) : WidgetRenderState
      data object DataStale : WidgetRenderState
    }
    ```
    Icon names (String) replace old `ImageVector` — per phase-02.md.

    **WidgetIssue.kt:**
    ```kotlin
    @Immutable
    data class WidgetIssue(
      val type: IssueType,
      val message: String,
      val resolution: ResolutionAction? = null,
    )

    enum class IssueType { SETUP, CONNECTION, ENTITLEMENT, DATA, PROVIDER }

    sealed interface ResolutionAction {
      data class OpenSetup(val sourceId: String) : ResolutionAction
      data class RequestPermission(val widgetId: String, val sourceId: String) : ResolutionAction
      data object OpenSettings : ResolutionAction
      data class Retry(val widgetId: String) : ResolutionAction
    }
    ```

    **WidgetStatusCache.kt:**
    - `@Immutable data class WidgetStatusCache(val overlayState: WidgetRenderState, val issues: ImmutableList<WidgetIssue>)`
    - `companion object { val EMPTY = WidgetStatusCache(WidgetRenderState.Ready, persistentListOf()) }`

    **ThemeSpec.kt (package: app.dqxn.android.sdk.contracts.theme):**
    - `interface ThemeSpec : Gated { val themeId: String; val displayName: String; val isDark: Boolean; val packId: String? }`
    - Metadata only — no Compose types. `DashboardThemeDefinition` with `Brush`, `Color` lives in `:sdk:ui` (Phase 3).

    **ThemeProvider.kt:**
    - `interface ThemeProvider { val packId: String; fun getThemes(): List<ThemeSpec> }`

    **AutoSwitchMode.kt:**
    - `enum class AutoSwitchMode { LIGHT, DARK, SYSTEM, SOLAR_AUTO, ILLUMINANCE_AUTO }`

    **DashboardPackManifest.kt (package: app.dqxn.android.sdk.contracts.pack):**
    ```kotlin
    @Serializable
    @Immutable
    data class DashboardPackManifest(
      val packId: String,
      val displayName: String,
      val description: String,
      val version: Int,
      val widgets: ImmutableList<PackWidgetRef>,
      val themes: ImmutableList<PackThemeRef>,
      val dataProviders: ImmutableList<PackDataProviderRef>,
      val category: PackCategory,
      val entitlementId: String?,
    )

    @Serializable @Immutable data class PackWidgetRef(val typeId: String, val displayName: String)
    @Serializable @Immutable data class PackThemeRef(val themeId: String, val displayName: String)
    @Serializable @Immutable data class PackDataProviderRef(val sourceId: String, val displayName: String, val dataType: String)
    @Serializable enum class PackCategory { ESSENTIALS, PREMIUM, REGIONAL, DEBUG }
    ```

    **WidgetRegistry.kt (package: app.dqxn.android.sdk.contracts.registry):**
    - `interface WidgetRegistry { fun getAll(): Set<WidgetRenderer>; fun findByTypeId(typeId: String): WidgetRenderer?; fun getTypeIds(): Set<String> }`

    **DataProviderRegistry.kt:**
    - `interface DataProviderRegistry { fun getAll(): Set<DataProvider<*>>; fun findByDataType(dataType: String): List<DataProvider<*>>; fun getFiltered(entitlementCheck: (String) -> Boolean): Set<DataProvider<*>> }`
  </action>
  <verify>
    <automated>cd /Users/ohm/Workspace/dqxn/android && ./gradlew :sdk:contracts:assembleDebug --console=plain 2>&1 | tail -10</automated>
    <manual>Verify all types compile and assembleDebug produces AAR</manual>
  </verify>
  <done>Complete `:sdk:contracts` type surface: notification types (InAppNotification Toast/Banner, NotificationPriority, AlertProfile with AlertMode/ttsMessage/soundUri, AlertEmitter, AlertResult, NotificationAction), status types (WidgetRenderState 8 variants, WidgetIssue, WidgetStatusCache), theme types (ThemeSpec, ThemeProvider, AutoSwitchMode), pack manifest (DashboardPackManifest with refs), registry interfaces (WidgetRegistry, DataProviderRegistry). assembleDebug succeeds.</done>
</task>

</tasks>

<verification>
1. `./gradlew :sdk:contracts:assembleDebug --console=plain` — full AAR produced
2. `./gradlew spotlessCheck --console=plain` — formatting clean
3. All `:sdk:contracts` types compile against compileOnly compose-runtime
4. Verify no `ImageVector`, no `Context`-dependent lambdas, no `@Composable` lambdas in contracts
</verification>

<success_criteria>
- Complete `:sdk:contracts` main source set: widget (8 types), provider (10 types), setup (7 subtypes + evaluator + enums), settings (12 subtypes + enums + helper), notification (6 types), status (3 types), theme (3 types), entitlement (3 types), pack (1 manifest + 3 refs + category), registry (2 interfaces), annotation (3), fault (1)
- Three-layer visibility on all SetupDefinition and SettingDefinition subtypes
- Setting wrapper double-gating preserved per replication advisory §7
- No Compose types beyond annotations
- No Android Context dependencies in contracts
</success_criteria>

<output>
After completion, create `.planning/phases/02-sdk-contracts-common/02-03-SUMMARY.md`
</output>
