---
phase: 10.1-fix-issues-3-and-4
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardThemeProvider.kt
  - android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/model/ThemeProviderInfo.kt
  - android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/handlers/ThemeProviderHandler.kt
  - android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/PluginProcessor.kt
  - android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/ManifestGenerator.kt
  - android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/HiltModuleGenerator.kt
  - android/build-logic/convention/src/main/kotlin/PackConventionPlugin.kt
  - android/codegen/plugin/src/test/kotlin/app/dqxn/android/codegen/plugin/ContractStubs.kt
  - android/codegen/plugin/src/test/kotlin/app/dqxn/android/codegen/plugin/PluginProcessorTest.kt
  - android/pack/essentials/src/main/kotlin/app/dqxn/android/pack/essentials/theme/EssentialsThemeProvider.kt
  - android/pack/essentials/src/main/kotlin/app/dqxn/android/pack/essentials/theme/EssentialsThemeModule.kt
  - android/pack/themes/src/main/kotlin/app/dqxn/android/pack/themes/ThemesPackThemeProvider.kt
  - android/pack/themes/src/main/kotlin/app/dqxn/android/pack/themes/ThemesThemeModule.kt
autonomous: true
requirements:
  - NF27

must_haves:
  truths:
    - "KSP generates correct PackCategory per pack (ESSENTIALS for essentials, PREMIUM for plus/themes, DEBUG for demo) -- not hardcoded ESSENTIALS for all"
    - "Generated DashboardPackManifest is Hilt-injected via @Provides @IntoSet into Set<DashboardPackManifest> -- not dead code on a static val"
    - "@DashboardThemeProvider annotation on a ThemeProvider class auto-generates @Binds @IntoSet Hilt binding -- no manual Hilt module needed"
    - "Generated manifest populates themes field with PackThemeRef entries for packs that have @DashboardThemeProvider -- not empty persistentListOf()"
    - "Test stub PackCategory enum matches real enum (ESSENTIALS, PREMIUM, REGIONAL, DEBUG) -- not stale (PLUS, THEMES, DEMO)"
    - "Manual EssentialsThemeModule.kt and ThemesThemeModule.kt deleted -- replaced by generated code"
  artifacts:
    - path: "android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardThemeProvider.kt"
      provides: "@DashboardThemeProvider annotation"
      contains: "annotation class DashboardThemeProvider"
    - path: "android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/handlers/ThemeProviderHandler.kt"
      provides: "KSP handler scanning @DashboardThemeProvider"
      contains: "class ThemeProviderHandler"
    - path: "android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/model/ThemeProviderInfo.kt"
      provides: "Data model for theme provider info"
      contains: "data class ThemeProviderInfo"
    - path: "android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/HiltModuleGenerator.kt"
      provides: "Generated @Binds @IntoSet for ThemeProvider + @Provides @IntoSet for manifest"
      contains: "ThemeProvider"
    - path: "android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/ManifestGenerator.kt"
      provides: "Category from KSP arg, populated themes field"
      contains: "packCategory"
  key_links:
    - from: "PackConventionPlugin.kt"
      to: "PluginProcessor.kt"
      via: "KSP arg packCategory"
      pattern: 'arg\("packCategory"'
    - from: "PluginProcessor.kt"
      to: "ThemeProviderHandler"
      via: "handler invocation"
      pattern: "ThemeProviderHandler.*process"
    - from: "HiltModuleGenerator.kt"
      to: "ThemeProvider multibinding"
      via: "@Binds @IntoSet"
      pattern: "THEME_PROVIDER"
    - from: "HiltModuleGenerator.kt"
      to: "DashboardPackManifest multibinding"
      via: "@Provides @IntoSet"
      pattern: "DASHBOARD_PACK_MANIFEST"
---

<objective>
Fix KSP ManifestGenerator hardcoded PackCategory.ESSENTIALS for all packs, wire generated manifest into Hilt multibinding (currently dead code), add @DashboardThemeProvider annotation + KSP handler to auto-generate ThemeProvider Hilt bindings (eliminating manual modules), and fix test stub PackCategory enum mismatch.

Purpose: The codegen currently produces incorrect metadata for all non-essentials packs and generates a manifest that nothing consumes at runtime. Theme providers require manual Hilt modules that KSP should automate.

Output: Correct per-pack manifest generation, Hilt-injected manifests, auto-generated theme provider bindings, deleted manual theme modules.
</objective>

<execution_context>
@/Users/ohm/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ohm/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10.1-fix-issues-3-and-4/10.1-RESEARCH.md
@android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/PluginProcessor.kt
@android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/ManifestGenerator.kt
@android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/HiltModuleGenerator.kt
@android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/handlers/WidgetHandler.kt
@android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/handlers/DataProviderHandler.kt
@android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/model/WidgetInfo.kt
@android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/model/ProviderInfo.kt
@android/codegen/plugin/src/test/kotlin/app/dqxn/android/codegen/plugin/ContractStubs.kt
@android/codegen/plugin/src/test/kotlin/app/dqxn/android/codegen/plugin/PluginProcessorTest.kt
@android/build-logic/convention/src/main/kotlin/PackConventionPlugin.kt
@android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/pack/DashboardPackManifest.kt
@android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/theme/ThemeProvider.kt
@android/pack/essentials/src/main/kotlin/app/dqxn/android/pack/essentials/theme/EssentialsThemeModule.kt
@android/pack/essentials/src/main/kotlin/app/dqxn/android/pack/essentials/theme/EssentialsThemeProvider.kt
@android/pack/themes/src/main/kotlin/app/dqxn/android/pack/themes/ThemesThemeModule.kt
@android/pack/themes/src/main/kotlin/app/dqxn/android/pack/themes/ThemesPackThemeProvider.kt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix ManifestGenerator + HiltModuleGenerator + add ThemeProvider codegen</name>
  <files>
    android/sdk/contracts/src/main/kotlin/app/dqxn/android/sdk/contracts/annotation/DashboardThemeProvider.kt
    android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/model/ThemeProviderInfo.kt
    android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/handlers/ThemeProviderHandler.kt
    android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/PluginProcessor.kt
    android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/ManifestGenerator.kt
    android/codegen/plugin/src/main/kotlin/app/dqxn/android/codegen/plugin/generation/HiltModuleGenerator.kt
    android/build-logic/convention/src/main/kotlin/PackConventionPlugin.kt
  </files>
  <action>
    **1. Create `@DashboardThemeProvider` annotation** in `:sdk:contracts` at `annotation/DashboardThemeProvider.kt`:
    ```kotlin
    package app.dqxn.android.sdk.contracts.annotation

    @Retention(AnnotationRetention.SOURCE)
    @Target(AnnotationTarget.CLASS)
    public annotation class DashboardThemeProvider
    ```
    No parameters -- packId comes from KSP arg, and theme metadata is a runtime concern (ThemeProvider.packId + ThemeProvider.getThemes()).

    **2. Create `ThemeProviderInfo` model** at `codegen/plugin/src/main/kotlin/.../model/ThemeProviderInfo.kt`:
    ```kotlin
    package app.dqxn.android.codegen.plugin.model

    import com.google.devtools.ksp.symbol.KSFile
    import com.squareup.kotlinpoet.ClassName

    internal data class ThemeProviderInfo(
      val className: String,
      val packageName: String,
      val typeName: ClassName,
      val originatingFile: KSFile,
    )
    ```

    **3. Create `ThemeProviderHandler`** at `codegen/plugin/src/main/kotlin/.../handlers/ThemeProviderHandler.kt`:
    Follow the same pattern as `WidgetHandler` and `DataProviderHandler`:
    - `process()` calls `resolver.getSymbolsWithAnnotation(DASHBOARD_THEME_PROVIDER_FQN)` filtered to `KSClassDeclaration`
    - `extractThemeProviderInfo()` validates the class implements `ThemeProvider` (FQN: `app.dqxn.android.sdk.contracts.theme.ThemeProvider`) via `classDecl.superTypes.any { ... }`. Log error and return null if not.
    - Resolve containingFile, log error if null.
    - Return `ThemeProviderInfo(className, packageName, typeName via toClassName(), originatingFile)`.
    - FQN constants: `DASHBOARD_THEME_PROVIDER_FQN = "app.dqxn.android.sdk.contracts.annotation.DashboardThemeProvider"`, `THEME_PROVIDER_FQN = "app.dqxn.android.sdk.contracts.theme.ThemeProvider"`.

    **4. Update `PluginProcessor.process()`**:
    - Add `val themeProviderInfos = ThemeProviderHandler(resolver, logger).process()` alongside existing widget/provider/snapshot handler calls.
    - Pass `themeProviderInfos` to both `HiltModuleGenerator.generate()` and `ManifestGenerator.generate()`.
    - Read `packCategory` from `options["packCategory"]` (nullable -- default to `"ESSENTIALS"` if missing for backward compatibility with modules not using the convention plugin).

    **5. Update `ManifestGenerator`**:
    - Change `generate()` signature to accept `packCategory: String` and `themeProviders: List<ThemeProviderInfo>` in addition to existing params.
    - `buildManifestInitializer()`: Replace hardcoded `PackCategory.ESSENTIALS` with `PackCategory.${packCategory}`. Since packCategory is a string matching the enum name, use `%T.%L` with PACK_CATEGORY and the packCategory string.
    - Populate the `themes` field: if `themeProviders` is non-empty, we cannot directly list individual themes at codegen time (themes are loaded at runtime by the provider class). Instead, leave themes as `persistentListOf()` -- this is acceptable because the manifest's themes field would require runtime introspection of getThemes() which KSP cannot do. The manifest is primarily for metadata; runtime theme catalog comes from `Set<ThemeProvider>`. HOWEVER, add a comment explaining this.
    - Alternatively, if the research mandates populating themes: for each `ThemeProviderInfo`, we'd need theme IDs, but the handler doesn't have access to those (they're runtime data). So keep `themes = persistentListOf()` but add the originating files from themeProviders for incremental tracking.
    - Add originating KSFile from each themeProvider to the manifest object builder.

    **6. Update `HiltModuleGenerator`**:
    - Change `generate()` signature to accept `themeProviders: List<ThemeProviderInfo>` and `manifestObjectName: String?` (the FQN of the generated manifest object, or null if no manifest).
    - Update the early-return guard: `if (widgets.isEmpty() && providers.isEmpty() && themeProviders.isEmpty()) return` -- but actually, we always want the module generated if there's a manifest to inject, so the condition should also check manifestObjectName.
    - For each `ThemeProviderInfo`, add `@Binds @IntoSet` binding:
      ```kotlin
      FunSpec.builder("bind${themeProvider.className}")
        .addModifiers(KModifier.ABSTRACT)
        .addAnnotation(DAGGER_BINDS)
        .addAnnotation(DAGGER_INTO_SET)
        .addParameter("impl", themeProvider.typeName)
        .returns(THEME_PROVIDER)
        .build()
      ```
    - Add companion val: `val THEME_PROVIDER = ClassName("app.dqxn.android.sdk.contracts.theme", "ThemeProvider")`
    - For manifest injection, the HiltModuleGenerator needs a **concrete** method (not abstract @Binds) because the manifest is a generated object, not an injectable class. Use a companion object or separate approach:
      - Actually, the clean approach: Convert the generated module from a pure `interface` (all @Binds) to an `abstract class` when there's a manifest to @Provides. Or: keep interface for @Binds, add a companion object with @Provides.
      - **Best approach for Dagger**: Use a companion object inside the interface. Dagger supports `@Module` interfaces with `companion object` containing `@Provides` methods (since Dagger 2.26+).
      - Add a `companion object` to the interface with a `@Provides @IntoSet` function returning `DashboardPackManifest`:
        ```kotlin
        companion object {
          @Provides
          @IntoSet
          @JvmStatic
          fun provideManifest(): DashboardPackManifest = {ManifestObjectName}.manifest
        }
        ```
      - The manifest object's package is `app.dqxn.android.pack.{packId}.generated` and name is `{PackId}GeneratedManifest`. Pass the ClassName of the manifest object to HiltModuleGenerator.
    - Add companion vals: `val DAGGER_PROVIDES = ClassName("dagger", "Provides")`, `val DAGGER_JVM_STATIC = ClassName("kotlin.jvm", "JvmStatic")` (actually JvmStatic is just `@JvmStatic` -- use `JvmStatic::class` annotation), `val DASHBOARD_PACK_MANIFEST = ClassName("app.dqxn.android.sdk.contracts.pack", "DashboardPackManifest")`.
    - For the `@JvmStatic` annotation: use `AnnotationSpec.builder(ClassName("kotlin.jvm", "JvmStatic")).build()`.
    - The `generate()` should always run now (even with empty widgets/providers/themeProviders) because the manifest @Provides is always needed. Guard: only skip if there's truly nothing (no widgets, no providers, no themes, and no manifest). Since manifest is always generated by ManifestGenerator, always generate the Hilt module too.
    - Update the `aggregating` flag: HiltModule currently uses `aggregating = false` (per-class isolation). Since it now references the aggregated manifest object, it needs `aggregating = true`. Actually -- the HiltModule depends on the manifest which is aggregating. KSP requirement: if the output references aggregating outputs, it should also be aggregating. Change to `aggregating = true`.

    **7. Update `PackConventionPlugin`**:
    - Add `packCategory` KSP arg derived from packId:
      ```kotlin
      val packCategory = when (project.name) {
        "essentials" -> "ESSENTIALS"
        "plus" -> "PREMIUM"
        "themes" -> "PREMIUM"
        "demo" -> "DEBUG"
        else -> "ESSENTIALS" // safe default
      }
      arg("packCategory", packCategory)
      ```
    - Add inside the existing `extensions.configure<KspExtension>` block.

    **Important implementation notes:**
    - The `PluginProcessor` must pass the manifest ClassName to HiltModuleGenerator so it can reference the manifest object in the @Provides method. Compute: `val manifestClassName = ClassName("app.dqxn.android.pack.$packId.generated", "${packId.replaceFirstChar { it.uppercase() }}GeneratedManifest")`.
    - ManifestGenerator must run BEFORE HiltModuleGenerator (or at least the name must be deterministic -- it already is, so order doesn't matter for code generation, only for the ClassName computation which is done in PluginProcessor).
    - For KotlinPoet: the companion object @Provides method references the generated manifest object. Use `%T.manifest` with the manifest ClassName.
  </action>
  <verify>
    <automated>cd android && ./gradlew :codegen:plugin:compileKotlin --console=plain 2>&1 | tail -5</automated>
  </verify>
  <done>
    - @DashboardThemeProvider annotation exists in :sdk:contracts
    - ThemeProviderHandler scans annotation and validates ThemeProvider supertype
    - ManifestGenerator reads packCategory from KSP arg (not hardcoded ESSENTIALS)
    - HiltModuleGenerator produces @Binds @IntoSet for ThemeProvider classes
    - HiltModuleGenerator produces @Provides @IntoSet for DashboardPackManifest
    - PackConventionPlugin passes packCategory KSP arg derived from packId
    - :codegen:plugin compiles successfully
  </done>
</task>

<task type="auto">
  <name>Task 2: Update test stubs + tests + pack modules, delete manual theme modules</name>
  <files>
    android/codegen/plugin/src/test/kotlin/app/dqxn/android/codegen/plugin/ContractStubs.kt
    android/codegen/plugin/src/test/kotlin/app/dqxn/android/codegen/plugin/PluginProcessorTest.kt
    android/pack/essentials/src/main/kotlin/app/dqxn/android/pack/essentials/theme/EssentialsThemeProvider.kt
    android/pack/essentials/src/main/kotlin/app/dqxn/android/pack/essentials/theme/EssentialsThemeModule.kt
    android/pack/themes/src/main/kotlin/app/dqxn/android/pack/themes/ThemesPackThemeProvider.kt
    android/pack/themes/src/main/kotlin/app/dqxn/android/pack/themes/ThemesThemeModule.kt
  </files>
  <action>
    **1. Fix `ContractStubs.kt` PackCategory enum** in `manifestStubs()`:
    Change:
    ```kotlin
    enum class PackCategory {
        ESSENTIALS,
        PLUS,
        THEMES,
        DEMO,
    }
    ```
    To match real enum:
    ```kotlin
    enum class PackCategory {
        ESSENTIALS,
        PREMIUM,
        REGIONAL,
        DEBUG,
    }
    ```

    **2. Add ThemeProvider + DashboardThemeProvider stubs** to `contractStubs()`:
    - Add `ThemeProvider.kt` stub:
      ```kotlin
      SourceFile.kotlin("ThemeProviderStub.kt", """
        package app.dqxn.android.sdk.contracts.theme

        interface ThemeProvider {
            val packId: String
        }
      """.trimIndent())
      ```
    - Add `DashboardThemeProvider.kt` stub:
      ```kotlin
      SourceFile.kotlin("DashboardThemeProviderAnnotation.kt", """
        package app.dqxn.android.sdk.contracts.annotation

        @Retention(AnnotationRetention.SOURCE)
        @Target(AnnotationTarget.CLASS)
        annotation class DashboardThemeProvider
      """.trimIndent())
      ```

    **3. Add Dagger `@Provides` and `@JvmStatic` stubs** to `daggerStubs()`:
    ```kotlin
    SourceFile.kotlin("DaggerProvides.kt", """
      package dagger

      @Retention(AnnotationRetention.RUNTIME)
      @Target(AnnotationTarget.FUNCTION)
      annotation class Provides
    """.trimIndent())
    ```
    (Note: `@JvmStatic` is a Kotlin stdlib annotation, should be available in compile-testing classpath already via `inheritClassPath = true`.)

    **4. Update `DashboardPackManifest` stub** in `manifestStubs()`:
    The `themes` field type is currently `List<Any>`. Change to `List<PackThemeRef>` and add `PackThemeRef` stub:
    ```kotlin
    SourceFile.kotlin("PackThemeRef.kt", """
      package app.dqxn.android.sdk.contracts.pack

      data class PackThemeRef(
          val themeId: String,
          val displayName: String,
      )
    """.trimIndent())
    ```
    Update `DashboardPackManifest` stub to use `List<PackThemeRef>` for the `themes` field.

    **5. Update `compile()` helper** in `PluginProcessorTest`:
    The `compile()` function passes `processorOptions["packId"] = packId`. Add `processorOptions["packCategory"] = packCategory` with default `"ESSENTIALS"`:
    ```kotlin
    private fun compile(
      vararg sources: SourceFile,
      packId: String = "essentials",
      packCategory: String = "ESSENTIALS",
    ): JvmCompilationResult {
      // ... existing setup ...
      configureKsp {
        symbolProcessorProviders += PluginProcessorProvider()
        processorOptions["packId"] = packId
        processorOptions["packCategory"] = packCategory
      }
    }
    ```

    **6. Update existing tests** to account for new generated code:
    - `valid DashboardWidget generates Hilt module`: Also assert manifest `@Provides @IntoSet` method exists in generated HiltModule. Assert `provideManifest` function name. Also assert the Hilt module file IS generated even for this case (it now always generates because of manifest @Provides).
    - `PackManifest object is generated with widget and provider refs`: Assert `PackCategory.ESSENTIALS` appears (explicitly, since we pass packCategory="ESSENTIALS").
    - `module with no annotations produces only manifest`: Update -- HiltModule IS now generated (because it contains manifest @Provides). Change assertion from `doesNotContain("EssentialsHiltModule.kt")` to `contains("EssentialsHiltModule.kt")` and verify it has the @Provides method but no @Binds methods.

    **7. Add new tests:**

    a. **`@DashboardThemeProvider generates Hilt binding`**: Source with a class annotated `@DashboardThemeProvider` implementing `ThemeProvider`. Compile with packId="essentials". Assert generated HiltModule contains `bindEssentialsThemeProvider` (or whatever the class name is) with `@Binds @IntoSet` returning `ThemeProvider`.

    b. **`@DashboardThemeProvider on non-ThemeProvider fails`**: Source with `@DashboardThemeProvider` on a plain class (not implementing ThemeProvider). Assert compilation fails with error message mentioning "must implement ThemeProvider".

    c. **`packCategory arg produces correct manifest category`**: Compile with `packCategory = "PREMIUM"`. Assert generated manifest contains `PackCategory.PREMIUM` (not ESSENTIALS).

    d. **`generated manifest is Hilt-injected via @Provides @IntoSet`**: Compile a valid widget source. Assert the HiltModule contains `@Provides`, `@IntoSet`, `provideManifest`, `DashboardPackManifest`.

    e. **`packCategory defaults to ESSENTIALS when missing`**: Compile without passing packCategory option. The PluginProcessor should default to "ESSENTIALS". Assert manifest contains `PackCategory.ESSENTIALS`. (Modify compile helper to support omitting packCategory -- add an `includePackCategory: Boolean = true` flag, or just test by verifying the processor handles missing option.)

    **8. Add `@DashboardThemeProvider` to pack providers:**
    - `EssentialsThemeProvider.kt`: Add `import app.dqxn.android.sdk.contracts.annotation.DashboardThemeProvider` and `@DashboardThemeProvider` annotation before `@Singleton`.
    - `ThemesPackThemeProvider.kt`: Same -- add `@DashboardThemeProvider` annotation.

    **9. Delete manual Hilt modules:**
    - DELETE `android/pack/essentials/src/main/kotlin/app/dqxn/android/pack/essentials/theme/EssentialsThemeModule.kt`
    - DELETE `android/pack/themes/src/main/kotlin/app/dqxn/android/pack/themes/ThemesThemeModule.kt`
  </action>
  <verify>
    <automated>cd android && ./gradlew :codegen:plugin:test --console=plain 2>&1 | tail -20</automated>
  </verify>
  <done>
    - ContractStubs PackCategory matches real enum (ESSENTIALS, PREMIUM, REGIONAL, DEBUG)
    - ThemeProvider and DashboardThemeProvider stubs added for compile-testing
    - @Provides stub added to dagger stubs
    - PackThemeRef stub added to manifest stubs
    - compile() helper accepts packCategory parameter
    - All existing tests updated to account for always-generated HiltModule (manifest @Provides)
    - 5 new tests: theme provider Hilt binding, non-ThemeProvider error, packCategory PREMIUM, manifest Hilt injection, packCategory default
    - EssentialsThemeProvider and ThemesPackThemeProvider annotated with @DashboardThemeProvider
    - EssentialsThemeModule.kt and ThemesThemeModule.kt deleted
    - All codegen tests pass
  </done>
</task>

</tasks>

<verification>
1. `cd android && ./gradlew :codegen:plugin:test --console=plain` — all compile-testing tests pass (existing + 5 new)
2. `cd android && ./gradlew :pack:essentials:compileDebugKotlin --console=plain` — essentials pack compiles with @DashboardThemeProvider (KSP generates binding, no manual module)
3. `cd android && ./gradlew :pack:themes:compileDebugKotlin --console=plain` — themes pack compiles with @DashboardThemeProvider
4. `cd android && ./gradlew test --console=plain` — full test suite passes (no regressions)
5. Verify generated EssentialsHiltModule.kt contains `bindEssentialsThemeProvider` returning `ThemeProvider` and `provideManifest` returning `DashboardPackManifest`
6. Verify generated EssentialsGeneratedManifest.kt contains `PackCategory.ESSENTIALS` (not hardcoded pattern -- derived from arg)
</verification>

<success_criteria>
- KSP generates per-pack PackCategory from convention plugin arg
- Generated manifest enters Hilt's Set<DashboardPackManifest> via @Provides @IntoSet
- @DashboardThemeProvider produces @Binds @IntoSet ThemeProvider binding
- Manual theme modules deleted; packs compile without them
- Test stub PackCategory corrected; 5+ new compile-tests pass
- Zero regressions in existing codegen tests and pack compilation
</success_criteria>

<output>
After completion, create `.planning/phases/10.1-fix-issues-3-and-4/10.1-01-SUMMARY.md`
</output>
