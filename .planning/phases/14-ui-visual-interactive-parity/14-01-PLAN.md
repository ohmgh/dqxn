---
phase: 14-ui-visual-interactive-parity
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - android/app/src/main/res/values/themes.xml
  - android/app/src/main/res/values-v31/themes.xml
  - android/app/src/main/AndroidManifest.xml
  - android/app/src/test/kotlin/app/dqxn/android/SplashThemeTest.kt
autonomous: true
requirements: []

must_haves:
  truths:
    - "Splash screen shows dark background (#0f172a) with app letterform icon on cold start"
    - "Post-splash theme transitions to Theme.Dqxn.NoActionBar seamlessly"
    - "API 31+ uses native splash screen attributes"
  artifacts:
    - path: "android/app/src/main/res/values/themes.xml"
      provides: "Theme.App.Starting with splash background and icon"
      contains: "windowSplashScreenBackground"
    - path: "android/app/src/main/res/values-v31/themes.xml"
      provides: "API 31+ native splash attributes"
      contains: "android:windowSplashScreenBackground"
    - path: "android/app/src/test/kotlin/app/dqxn/android/SplashThemeTest.kt"
      provides: "Splash theme XML validation test"
  key_links:
    - from: "android/app/src/main/AndroidManifest.xml"
      to: "android/app/src/main/res/values/themes.xml"
      via: "android:theme=\"@style/Theme.App.Starting\""
      pattern: "Theme\\.App\\.Starting"
---

<objective>
Implement splash screen theme with branded dark background and letterform icon.

Purpose: Eliminate white flash on cold start. The `installSplashScreen()` call exists in MainActivity
but lacks the XML theme configuration (`Theme.App.Starting`) and the manifest reference. Without the
XML theme, the splash screen shows system default colors.

Output: `Theme.App.Starting` style in `values/themes.xml` and `values-v31/themes.xml`, manifest
updated to use splash theme on activity.
</objective>

<execution_context>
@/Users/ohm/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ohm/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@android/app/src/main/res/values/themes.xml
@android/app/src/main/AndroidManifest.xml
@android/app/src/main/res/drawable/ic_logo_letterform.xml

<interfaces>
<!-- The drawable `ic_logo_letterform` already exists at android/app/src/main/res/drawable/ic_logo_letterform.xml -->
<!-- installSplashScreen() is already called in MainActivity.onCreate() -->
<!-- Current themes.xml has only Theme.Dqxn.NoActionBar parenting Theme.DeviceDefault.NoActionBar -->
<!-- Current manifest references android:theme="@style/Theme.Dqxn.NoActionBar" on the activity -->
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create splash screen theme and update manifest</name>
  <files>
    android/app/src/main/res/values/themes.xml
    android/app/src/main/res/values-v31/themes.xml
    android/app/src/main/AndroidManifest.xml
  </files>
  <action>
1. **Update `android/app/src/main/res/values/themes.xml`**: Add `Theme.App.Starting` style:
```xml
<style name="Theme.App.Starting" parent="Theme.SplashScreen">
    <item name="windowSplashScreenBackground">#0f172a</item>
    <item name="windowSplashScreenAnimatedIcon">@drawable/ic_logo_letterform</item>
    <item name="postSplashScreenTheme">@style/Theme.Dqxn.NoActionBar</item>
</style>
```
Keep the existing `Theme.Dqxn.NoActionBar` style unchanged.

2. **Create `android/app/src/main/res/values-v31/themes.xml`**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="Theme.App.Starting" parent="Theme.SplashScreen">
        <item name="windowSplashScreenBackground">#0f172a</item>
        <item name="windowSplashScreenAnimatedIcon">@drawable/ic_logo_letterform</item>
        <item name="postSplashScreenTheme">@style/Theme.Dqxn.NoActionBar</item>
        <item name="android:windowSplashScreenBackground">#0f172a</item>
        <item name="android:windowSplashScreenAnimatedIcon">@drawable/ic_logo_letterform</item>
        <item name="android:windowSplashScreenBehavior">@integer/icon_preferred</item>
    </style>
</resources>
```

3. **Update `android/app/src/main/AndroidManifest.xml`**: Change the activity's `android:theme` from `@style/Theme.Dqxn.NoActionBar` to `@style/Theme.App.Starting`.

**Key:** The `postSplashScreenTheme` item makes AndroidX SplashScreen compat library swap to the real app theme after splash completes. `installSplashScreen()` in MainActivity handles this automatically.
  </action>
  <verify>
    <automated>cd android && ./gradlew :app:assembleDebug --console=plain 2>&1 | tail -5</automated>
  </verify>
  <done>
    - `Theme.App.Starting` defined in both `values/themes.xml` and `values-v31/themes.xml`
    - Manifest activity references `@style/Theme.App.Starting`
    - `postSplashScreenTheme` points to `@style/Theme.Dqxn.NoActionBar`
    - Debug build compiles without resource errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Add splash theme validation test</name>
  <files>
    android/app/src/test/kotlin/app/dqxn/android/SplashThemeTest.kt
  </files>
  <action>
Create a JUnit5 test that validates the splash theme XML files exist and contain the required attributes. Since we cannot use Robolectric easily with JUnit5, use source-file parsing to verify the XML content:

```kotlin
package app.dqxn.android

import com.google.common.truth.Truth.assertThat
import org.junit.jupiter.api.Test
import java.io.File

class SplashThemeTest {

    private val projectDir = File(System.getProperty("user.dir"))

    @Test
    fun `values themes xml contains Theme App Starting with splash background`() {
        val themesXml = File(projectDir, "app/src/main/res/values/themes.xml")
        assertThat(themesXml.exists()).isTrue()
        val content = themesXml.readText()
        assertThat(content).contains("Theme.App.Starting")
        assertThat(content).contains("windowSplashScreenBackground")
        assertThat(content).contains("#0f172a")
        assertThat(content).contains("postSplashScreenTheme")
        assertThat(content).contains("Theme.Dqxn.NoActionBar")
        assertThat(content).contains("ic_logo_letterform")
    }

    @Test
    fun `values-v31 themes xml contains native splash attributes`() {
        val themesV31 = File(projectDir, "app/src/main/res/values-v31/themes.xml")
        assertThat(themesV31.exists()).isTrue()
        val content = themesV31.readText()
        assertThat(content).contains("android:windowSplashScreenBackground")
        assertThat(content).contains("android:windowSplashScreenAnimatedIcon")
        assertThat(content).contains("android:windowSplashScreenBehavior")
        assertThat(content).contains("#0f172a")
    }

    @Test
    fun `manifest references splash theme on activity`() {
        val manifest = File(projectDir, "app/src/main/AndroidManifest.xml")
        assertThat(manifest.exists()).isTrue()
        val content = manifest.readText()
        assertThat(content).contains("@style/Theme.App.Starting")
    }
}
```

This test validates the XML structure without needing Android runtime. File paths are relative to the `android/` working directory (Gradle's `user.dir`).
  </action>
  <verify>
    <automated>cd android && ./gradlew :app:testDebugUnitTest --tests "*.SplashThemeTest" --console=plain 2>&1 | tail -10</automated>
  </verify>
  <done>
    - SplashThemeTest passes all 3 assertions
    - Validates splash background color, icon reference, post-splash theme, manifest reference
  </done>
</task>

</tasks>

<verification>
1. `cd android && ./gradlew :app:assembleDebug --console=plain` -- compiles without resource errors
2. `cd android && ./gradlew :app:testDebugUnitTest --tests "*.SplashThemeTest" --console=plain` -- all 3 tests pass
</verification>

<success_criteria>
- Splash screen theme (`Theme.App.Starting`) exists in both `values/` and `values-v31/`
- Manifest activity uses splash theme
- All splash theme validation tests pass
- Debug build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/14-ui-visual-interactive-parity/14-01-SUMMARY.md`
</output>
