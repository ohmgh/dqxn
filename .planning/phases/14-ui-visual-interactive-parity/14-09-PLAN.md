---
phase: 14-ui-visual-interactive-parity
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - android/feature/settings/src/main/kotlin/app/dqxn/android/feature/settings/main/MainSettings.kt
  - android/feature/settings/src/main/res/values/strings.xml
  - android/feature/dashboard/src/main/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayNavHost.kt
  - android/feature/dashboard/src/main/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayRoutes.kt
  - android/feature/settings/src/test/kotlin/app/dqxn/android/feature/settings/main/MainSettingsTest.kt
  - android/feature/dashboard/src/test/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayNavHostRouteTest.kt
autonomous: true
requirements: [F1.9, F4.6]

must_haves:
  truths:
    - "MainSettings item order: About Banner -> Divider -> Dash Packs -> Divider -> Theme Items (Theme Mode, Light Theme, Dark Theme) -> Divider -> Show Status Bar -> Divider -> Reset Dash -> Advanced section"
    - "About App banner is first item with tagline 'Life is a dash. Make it beautiful.', attribution '-- The Dashing Dachshund', DQXN name, version"
    - "Settings items with navigation arrows have icons in 40dp rounded-square box, accentColor.copy(alpha=0.1f) background, 24dp icon tinted accentColor"
    - "Each navigation settings item has subtitle/description below the label"
    - "Dash Packs subtitle shows dynamic counts: '$packCount packs, $themeCount themes, $widgetCount widgets, $providerCount providers'"
    - "Theme Mode subtitle shows autoSwitchModeDescription"
    - "Light Theme and Dark Theme navigation rows exist with current theme name subtitles"
    - "Reset Dash row has red text and subtitle 'Restore default layout and theme'"
    - "Show Status Bar has subtitle 'Applies to current dash'"
    - "AutoSwitchModeRoute added to OverlayRoutes.kt, wired in OverlayNavHost"
    - "ThemeSelectorRoute changed from data object to data class(isDark: Boolean)"
    - "onNavigateToThemeMode navigates to AutoSwitchModeRoute (not ThemeSelectorRoute)"
    - "onNavigateToLightTheme previews + navigates to ThemeSelectorRoute(isDark=false)"
    - "onNavigateToDarkTheme previews + navigates to ThemeSelectorRoute(isDark=true)"
    - "isDark from route passed to ThemeSelector in OverlayNavHost"
    - "onCreateNewTheme wired to navigate to ThemeStudioRoute(themeId=null)"
    - "All test call sites updated for new params and ThemeSelectorRoute(isDark) form"
  artifacts:
    - path: "android/feature/settings/src/main/kotlin/app/dqxn/android/feature/settings/main/MainSettings.kt"
      provides: "Reordered MainSettings with icons, descriptions, About banner, old codebase item order"
      contains: "AboutAppBanner"
    - path: "android/feature/dashboard/src/main/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayRoutes.kt"
      provides: "AutoSwitchModeRoute and ThemeSelectorRoute(isDark) routes"
      contains: "AutoSwitchModeRoute"
    - path: "android/feature/settings/src/test/kotlin/app/dqxn/android/feature/settings/main/MainSettingsTest.kt"
      provides: "Tests for item order, icons, descriptions, About banner, new params"
  key_links:
    - from: "OverlayNavHost.kt"
      to: "AutoSwitchModeContent.kt"
      via: "AutoSwitchModeRoute composable destination"
      pattern: "AutoSwitchModeRoute"
    - from: "MainSettings.kt"
      to: "OverlayNavHost.kt"
      via: "onNavigateToThemeMode, onNavigateToLightTheme, onNavigateToDarkTheme callbacks"
      pattern: "onNavigateToLightTheme"
---

<objective>
Full Settings UI parity: restructure MainSettings with old codebase item order, icons, descriptions, About banner, and fix all theme routing.

Purpose: Current MainSettings has a 4-section layout (Appearance, Behavior, Data & Privacy, Danger Zone) with no icons, no descriptions, wrong item order, no About banner, no Light/Dark Theme rows. Theme mode routing points to ThemeSelectorRoute instead of a mode selector. This plan fixes ALL MainSettings visual issues AND all routing changes, avoiding file conflicts with 14-06 (which only touches ThemeSelector.kt).

Output: Restructured MainSettings.kt, new AutoSwitchModeRoute + updated ThemeSelectorRoute(isDark) in OverlayRoutes.kt, updated OverlayNavHost wiring, all test updates.
</objective>

<execution_context>
@/Users/ohm/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ohm/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@android/feature/settings/src/main/kotlin/app/dqxn/android/feature/settings/main/MainSettings.kt
@android/feature/dashboard/src/main/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayNavHost.kt
@android/feature/dashboard/src/main/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayRoutes.kt
@android/feature/settings/src/main/kotlin/app/dqxn/android/feature/settings/theme/AutoSwitchModeContent.kt
@android/feature/settings/src/test/kotlin/app/dqxn/android/feature/settings/main/MainSettingsTest.kt
@android/feature/dashboard/src/test/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayNavHostRouteTest.kt

<interfaces>
<!-- Old codebase MainSettingsContent.kt item order:
     1. About App Banner -- tagline + attribution + DQXN + version
     2. HorizontalDivider
     3. "Dash Packs" -- icon: Icons.Default.Dashboard, subtitle: "$packCount packs, $themeCount themes, $widgetCount widgets, $providerCount providers"
     4. HorizontalDivider
     5. Theme Items Group (4dp spacing between):
        - "Theme Mode" -- icon: Icons.Default.SettingsBrightness, subtitle: autoSwitchMode description
        - "Light Theme" -- icon: Icons.Default.LightMode, subtitle: lightThemeName
        - "Dark Theme" -- icon: Icons.Default.DarkMode, subtitle: darkThemeName
     6. HorizontalDivider
     7. "Show Status Bar" -- no icon, subtitle: "Applies to current dash" (toggle)
     8. HorizontalDivider
     9. "Reset Dash" -- no icon, subtitle: "Restore default layout and theme", red text
-->

<!-- Old SettingsItemRow composable from old codebase:
     - Icon in 40dp rounded-square box, accentColor.copy(alpha = 0.1f) background, 24dp icon tinted accentColor
     - Has showArrow param (defaults false), navigation items show ChevronRight arrow
-->

<!-- Current MainSettings params:
     analyticsConsent, showStatusBar, keepScreenOn,
     onSetAnalyticsConsent, onSetShowStatusBar, onSetKeepScreenOn,
     onDeleteAllData, onNavigateToThemeMode, onNavigateToDashPacks,
     onNavigateToDiagnostics, onClose
-->

<!-- New params needed:
     lightThemeName: String, darkThemeName: String,
     packCount: Int, themeCount: Int, widgetCount: Int, providerCount: Int,
     autoSwitchModeDescription: String, versionName: String,
     onNavigateToLightTheme: () -> Unit, onNavigateToDarkTheme: () -> Unit,
     onResetDash: () -> Unit
-->

<!-- AutoSwitchModeContent already exists at:
     android/feature/settings/src/main/kotlin/app/dqxn/android/feature/settings/theme/AutoSwitchModeContent.kt
     It renders 5 radio rows (LIGHT, DARK, SYSTEM, SOLAR_AUTO, ILLUMINANCE_AUTO).
     Just needs a route + OverlayScaffold wrapper in OverlayNavHost.
-->

<!-- Current OverlayRoutes.kt routes:
     EmptyRoute, WidgetPickerRoute, SettingsRoute, WidgetSettingsRoute(widgetId),
     SetupRoute(providerId), ThemeSelectorRoute (data object), ThemeStudioRoute(themeId),
     DiagnosticsRoute, OnboardingRoute
-->

<!-- Theme routing fix:
     - onNavigateToThemeMode currently -> ThemeSelectorRoute (WRONG, should go to AutoSwitchModeRoute)
     - Need AutoSwitchModeRoute (data object) for mode selector
     - ThemeSelectorRoute changes from data object to data class(isDark: Boolean)
     - New: onNavigateToLightTheme -> ThemeSelectorRoute(isDark=false)
     - New: onNavigateToDarkTheme -> ThemeSelectorRoute(isDark=true)
-->

<!-- DashboardCommand relevant sealed subtypes to check:
     DashboardCommand.PreviewTheme, DashboardCommand.SetTheme,
     DashboardCommand.SetAutoSwitchMode?, DashboardCommand.SetIlluminanceThreshold?
     DashboardCommand.ResetLayout?
     Executor must verify these exist in DashboardCommand.kt
-->

<!-- Plan 14-06 adds isDark and onCreateNewTheme to ThemeSelector.kt.
     This plan wires isDark from ThemeSelectorRoute and onCreateNewTheme in OverlayNavHost.
     No file conflict: 14-06 touches ThemeSelector.kt, this plan touches OverlayNavHost.kt. -->
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add AutoSwitchModeRoute, update ThemeSelectorRoute, restructure MainSettings, fix routing</name>
  <files>
    android/feature/dashboard/src/main/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayRoutes.kt
    android/feature/dashboard/src/main/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayNavHost.kt
    android/feature/settings/src/main/kotlin/app/dqxn/android/feature/settings/main/MainSettings.kt
    android/feature/settings/src/main/res/values/strings.xml
  </files>
  <action>
**A. Update OverlayRoutes.kt:**

1. Add `AutoSwitchModeRoute`:
```kotlin
/** Auto-switch mode selector -- shows 5 mode radio rows. */
@Serializable
public data object AutoSwitchModeRoute
```

2. Change `ThemeSelectorRoute` from `data object` to `data class`:
```kotlin
/** Theme selector -- parameterized with isDark to filter themes for light/dark mode. */
@Serializable
public data class ThemeSelectorRoute(val isDark: Boolean = true)
```

**B. Update OverlayNavHost.kt:**

1. Add route pattern constant:
```kotlin
private val AUTO_SWITCH_MODE_ROUTE_PATTERN = AutoSwitchModeRoute::class.qualifiedName!!
```

2. Add `AutoSwitchModeRoute` composable destination (after SettingsRoute, before WidgetSettingsRoute). Import `AutoSwitchModeContent` from `app.dqxn.android.feature.settings.theme`. Wrap in OverlayScaffold:
```kotlin
composable<AutoSwitchModeRoute>(
    enterTransition = { DashboardMotion.previewEnter },
    exitTransition = { DashboardMotion.previewExit },
    popEnterTransition = { fadeIn(tween(150)) },
    popExitTransition = { DashboardMotion.previewExit },
) {
    val themeState by themeCoordinator.themeState.collectAsState()

    OverlayScaffold(
        title = "Theme Mode",
        overlayType = OverlayType.Preview,
        onClose = { navController.popBackStack() },
    ) {
        AutoSwitchModeContent(
            selectedMode = themeState.autoSwitchMode,
            illuminanceThreshold = themeState.illuminanceThreshold,
            entitlementManager = entitlementManager,
            onModeSelected = { mode -> onCommand(DashboardCommand.SetAutoSwitchMode(mode)) },
            onIlluminanceThresholdChanged = { threshold -> onCommand(DashboardCommand.SetIlluminanceThreshold(threshold)) },
        )
    }
}
```

**IMPORTANT:** Check that `DashboardCommand.SetAutoSwitchMode` and `DashboardCommand.SetIlluminanceThreshold` exist in DashboardCommand.kt. If not, check ThemeCoordinator for the correct command names. Add them if they don't exist. Also import `AutoSwitchModeContent`, `OverlayScaffold`, `OverlayType`.

3. Fix Settings route -- replace `onNavigateToThemeMode` callback to navigate to `AutoSwitchModeRoute`:
```kotlin
onNavigateToThemeMode = {
    navController.navigate(AutoSwitchModeRoute)
},
```
Remove the existing `DashboardCommand.PreviewTheme(darkTheme)` before navigation (preview not needed for mode selector).

4. Add `onNavigateToLightTheme` and `onNavigateToDarkTheme` callbacks in Settings route:
```kotlin
onNavigateToLightTheme = {
    val lightTheme = themeCoordinator.themeState.value.lightTheme
    onCommand(DashboardCommand.PreviewTheme(lightTheme))
    navController.navigate(ThemeSelectorRoute(isDark = false))
},
onNavigateToDarkTheme = {
    val darkTheme = themeCoordinator.themeState.value.darkTheme
    onCommand(DashboardCommand.PreviewTheme(darkTheme))
    navController.navigate(ThemeSelectorRoute(isDark = true))
},
```

5. Add remaining new params to MainSettings call site:
```kotlin
val themeState by themeCoordinator.themeState.collectAsState()

MainSettings(
    // ... existing params ...
    lightThemeName = themeState.lightTheme?.displayName ?: "Default",
    darkThemeName = themeState.darkTheme?.displayName ?: "Default",
    packCount = widgetRegistry.getAll().map { it.typeId.substringBefore(':') }.distinct().size,
    themeCount = allThemes.size,
    widgetCount = widgetRegistry.getAll().size,
    providerCount = dataProviderRegistry.getAll().size,
    autoSwitchModeDescription = themeState.autoSwitchMode.name.lowercase().replace('_', ' ').replaceFirstChar { it.uppercase() },
    versionName = "",  // TODO: inject via ViewModel
    onNavigateToLightTheme = { ... },  // as above
    onNavigateToDarkTheme = { ... },   // as above
    onResetDash = { onCommand(DashboardCommand.ResetLayout) },
)
```

Check if `DashboardCommand.ResetLayout` exists. If not, look for a similar command. If none exists, check if LayoutRepository has a reset method and create the command variant.

NOTE: The `themeState` collect may already exist from the ThemeSelectorRoute block. Reuse it if it's scoped at the NavHost level. If it's only inside the ThemeSelectorRoute composable block, add a separate collect inside the SettingsRoute block.

6. Update Settings exit/popEnter source-varying transitions to include AutoSwitchModeRoute:
```kotlin
exitTransition = {
    val target = targetState.destination.route ?: ""
    when {
        target.contains(THEME_SELECTOR_ROUTE_PATTERN) -> fadeOut(tween(100))
        target.contains(AUTO_SWITCH_MODE_ROUTE_PATTERN) -> fadeOut(tween(100))
        target.contains(DIAGNOSTICS_ROUTE_PATTERN) -> ExitTransition.None
        target.contains(ONBOARDING_ROUTE_PATTERN) -> ExitTransition.None
        else -> DashboardMotion.previewExit
    }
},
popEnterTransition = {
    val source = initialState.destination.route ?: ""
    when {
        source.contains(THEME_SELECTOR_ROUTE_PATTERN) -> fadeIn(tween(150))
        source.contains(AUTO_SWITCH_MODE_ROUTE_PATTERN) -> fadeIn(tween(150))
        source.contains(DIAGNOSTICS_ROUTE_PATTERN) -> EnterTransition.None
        source.contains(ONBOARDING_ROUTE_PATTERN) -> EnterTransition.None
        else -> DashboardMotion.previewEnter
    }
},
```

7. Update ThemeSelectorRoute composable to read `isDark` from route and pass to ThemeSelector:
```kotlin
composable<ThemeSelectorRoute>(...) { backStackEntry ->
    val route = backStackEntry.toRoute<ThemeSelectorRoute>()
    val themeState by themeCoordinator.themeState.collectAsState()

    ThemeSelector(
        allThemes = allThemes,
        isDark = route.isDark,
        // ... existing params ...
        onCreateNewTheme = {
            navController.navigate(ThemeStudioRoute(themeId = null))
        },
    )
}
```

**C. Restructure MainSettings.kt:**

1. Add new parameters:
```kotlin
@Composable
public fun MainSettings(
    analyticsConsent: Boolean,
    showStatusBar: Boolean,
    keepScreenOn: Boolean,
    lightThemeName: String = "",
    darkThemeName: String = "",
    packCount: Int = 0,
    themeCount: Int = 0,
    widgetCount: Int = 0,
    providerCount: Int = 0,
    autoSwitchModeDescription: String = "",
    versionName: String = "",
    onSetAnalyticsConsent: (Boolean) -> Unit,
    onSetShowStatusBar: (Boolean) -> Unit,
    onSetKeepScreenOn: (Boolean) -> Unit,
    onDeleteAllData: () -> Unit,
    onNavigateToThemeMode: () -> Unit,
    onNavigateToLightTheme: () -> Unit = {},
    onNavigateToDarkTheme: () -> Unit = {},
    onNavigateToDashPacks: () -> Unit,
    onNavigateToDiagnostics: () -> Unit,
    onResetDash: () -> Unit = {},
    onClose: () -> Unit,
    modifier: Modifier = Modifier,
)
```

2. Replace the 4-section layout with old codebase flat list. The Column content inside OverlayScaffold becomes:

```kotlin
Column(
    modifier = Modifier.fillMaxSize()
        .verticalScroll(rememberScrollState())
        .testTag("main_settings_content"),
) {
    // 1. About App Banner
    AboutAppBanner(versionName = versionName, theme = theme)

    SectionDivider(theme = theme)

    // 2. Dash Packs
    SettingsItemRow(
        label = stringResource(R.string.main_settings_dash_packs),
        subtitle = "$packCount packs, $themeCount themes, $widgetCount widgets, $providerCount providers",
        icon = Icons.Default.Dashboard,
        accentColor = theme.accentColor,
        theme = theme,
        showArrow = true,
        onClick = onNavigateToDashPacks,
        testTag = "main_settings_dash_packs",
    )

    SectionDivider(theme = theme)

    // 3. Theme Items Group (4dp spacing between)
    Column(verticalArrangement = Arrangement.spacedBy(4.dp)) {
        SettingsItemRow(
            label = stringResource(R.string.main_settings_theme_mode),
            subtitle = autoSwitchModeDescription,
            icon = Icons.Default.SettingsBrightness,
            accentColor = theme.accentColor,
            theme = theme,
            showArrow = true,
            onClick = onNavigateToThemeMode,
            testTag = "main_settings_theme_mode",
        )
        SettingsItemRow(
            label = stringResource(R.string.main_settings_light_theme),
            subtitle = lightThemeName,
            icon = Icons.Default.LightMode,
            accentColor = theme.accentColor,
            theme = theme,
            showArrow = true,
            onClick = onNavigateToLightTheme,
            testTag = "main_settings_light_theme",
        )
        SettingsItemRow(
            label = stringResource(R.string.main_settings_dark_theme),
            subtitle = darkThemeName,
            icon = Icons.Default.DarkMode,
            accentColor = theme.accentColor,
            theme = theme,
            showArrow = true,
            onClick = onNavigateToDarkTheme,
            testTag = "main_settings_dark_theme",
        )
    }

    SectionDivider(theme = theme)

    // 4. Show Status Bar (toggle, no icon)
    ToggleRow(
        label = stringResource(R.string.main_settings_status_bar),
        subtitle = stringResource(R.string.main_settings_status_bar_subtitle),
        checked = showStatusBar,
        onCheckedChange = onSetShowStatusBar,
        theme = theme,
        testTag = "main_settings_status_bar",
    )

    SectionDivider(theme = theme)

    // 5. Reset Dash (red text, no icon)
    ResetDashRow(theme = theme, onClick = onResetDash)

    SectionDivider(theme = theme)

    // --- Advanced (not in old codebase, kept for requirement compliance) ---
    SectionHeader(title = "Advanced", theme = theme)

    ToggleRow(
        label = stringResource(R.string.main_settings_keep_screen_on),
        checked = keepScreenOn,
        onCheckedChange = onSetKeepScreenOn,
        theme = theme,
        testTag = "main_settings_keep_screen_on",
    )
    AnalyticsToggleRow(
        checked = analyticsConsent,
        onToggle = { enabled ->
            if (enabled) showAnalyticsDialog = true
            else onSetAnalyticsConsent(false)
        },
        theme = theme,
    )
    NavigationRow(
        label = stringResource(R.string.main_settings_diagnostics),
        theme = theme,
        onClick = onNavigateToDiagnostics,
        testTag = "main_settings_diagnostics",
    )
    DeleteAllDataButton(theme = theme, onClick = { showDeleteDialog = true })

    Spacer(modifier = Modifier.height(DashboardSpacing.SpaceXL))
}
```

3. Create **AboutAppBanner** composable:
```kotlin
@Composable
private fun AboutAppBanner(
    versionName: String,
    theme: DashboardThemeDefinition,
    modifier: Modifier = Modifier,
) {
    Column(
        modifier = modifier.fillMaxWidth().padding(vertical = DashboardSpacing.SpaceL).testTag("about_app_banner"),
        horizontalAlignment = Alignment.CenterHorizontally,
    ) {
        Box(
            modifier = Modifier.size(64.dp).clip(CircleShape).background(theme.accentColor.copy(alpha = 0.15f)),
            contentAlignment = Alignment.Center,
        ) {
            Text(text = "D", style = DashboardTypography.title, color = theme.accentColor)
        }
        Spacer(modifier = Modifier.height(DashboardSpacing.SpaceS))
        Text(
            text = stringResource(R.string.about_app_tagline),
            style = DashboardTypography.description,
            color = theme.primaryTextColor.copy(alpha = TextEmphasis.Medium),
        )
        Text(
            text = stringResource(R.string.about_app_attribution),
            style = DashboardTypography.caption,
            color = theme.primaryTextColor.copy(alpha = TextEmphasis.Medium),
        )
        Spacer(modifier = Modifier.height(DashboardSpacing.SpaceXS))
        Text(text = "DQXN", style = DashboardTypography.sectionHeader, color = theme.primaryTextColor)
        if (versionName.isNotEmpty()) {
            Text(
                text = versionName,
                style = DashboardTypography.caption,
                color = theme.primaryTextColor.copy(alpha = TextEmphasis.Medium),
            )
        }
    }
}
```

4. Create **SettingsItemRow** composable (row with icon box + label + subtitle + arrow):
```kotlin
@Composable
private fun SettingsItemRow(
    label: String,
    subtitle: String,
    icon: ImageVector,
    accentColor: Color,
    theme: DashboardThemeDefinition,
    showArrow: Boolean = false,
    onClick: () -> Unit,
    testTag: String,
    modifier: Modifier = Modifier,
) {
    Row(
        modifier = modifier.fillMaxWidth().sizeIn(minHeight = 76.dp).clickable(onClick = onClick).testTag(testTag),
        verticalAlignment = Alignment.CenterVertically,
        horizontalArrangement = Arrangement.spacedBy(DashboardSpacing.SpaceM),
    ) {
        // 40dp rounded-square icon box with accentColor.copy(alpha=0.1f) background
        Box(
            modifier = Modifier.size(40.dp).clip(RoundedCornerShape(8.dp)).background(accentColor.copy(alpha = 0.1f)),
            contentAlignment = Alignment.Center,
        ) {
            Icon(imageVector = icon, contentDescription = null, tint = accentColor, modifier = Modifier.size(24.dp))
        }
        Column(modifier = Modifier.weight(1f)) {
            Text(text = label, style = DashboardTypography.itemTitle, color = theme.primaryTextColor)
            Text(
                text = subtitle,
                style = DashboardTypography.description,
                color = theme.primaryTextColor.copy(alpha = TextEmphasis.Medium),
                maxLines = 1,
            )
        }
        if (showArrow) {
            Icon(Icons.Filled.ChevronRight, null, tint = theme.primaryTextColor.copy(alpha = TextEmphasis.Medium))
        }
    }
}
```

5. Update **ToggleRow** to accept optional subtitle:
Add `subtitle: String? = null` parameter. When non-null, wrap label + subtitle in Column:
```kotlin
@Composable
private fun ToggleRow(
    label: String,
    checked: Boolean,
    onCheckedChange: (Boolean) -> Unit,
    theme: DashboardThemeDefinition,
    testTag: String,
    subtitle: String? = null,
    modifier: Modifier = Modifier,
) {
    // If subtitle provided, use Column layout for label + subtitle
}
```

6. Create **ResetDashRow** composable:
```kotlin
@Composable
private fun ResetDashRow(theme: DashboardThemeDefinition, onClick: () -> Unit, modifier: Modifier = Modifier) {
    Row(
        modifier = modifier.fillMaxWidth().sizeIn(minHeight = 76.dp).clickable(onClick = onClick).testTag("main_settings_reset_dash"),
        verticalAlignment = Alignment.CenterVertically,
    ) {
        Column(modifier = Modifier.weight(1f)) {
            Text(text = stringResource(R.string.main_settings_reset_dash), style = DashboardTypography.itemTitle, color = SemanticColors.Error)
            Text(
                text = stringResource(R.string.main_settings_reset_dash_subtitle),
                style = DashboardTypography.description,
                color = SemanticColors.Error.copy(alpha = TextEmphasis.Medium),
            )
        }
    }
}
```

7. Remove the old 4-section headers (APPEARANCE, BEHAVIOR, DATA & PRIVACY, DANGER ZONE) from the main flow. Keep `SectionHeader` composable for Advanced section.

8. Add new imports to MainSettings.kt:
```kotlin
import androidx.compose.material.icons.filled.Dashboard
import androidx.compose.material.icons.filled.DarkMode
import androidx.compose.material.icons.filled.LightMode
import androidx.compose.material.icons.filled.SettingsBrightness
import androidx.compose.foundation.shape.CircleShape
import androidx.compose.ui.graphics.vector.ImageVector
```

**D. Add string resources** to `android/feature/settings/src/main/res/values/strings.xml`:
```xml
<string name="about_app_tagline">Life is a dash. Make it beautiful.</string>
<string name="about_app_attribution">-- The Dashing Dachshund</string>
<string name="main_settings_light_theme">Light Theme</string>
<string name="main_settings_dark_theme">Dark Theme</string>
<string name="main_settings_status_bar_subtitle">Applies to current dash</string>
<string name="main_settings_reset_dash">Reset Dash</string>
<string name="main_settings_reset_dash_subtitle">Restore default layout and theme</string>
```

**E. Update existing test call sites** for ThemeSelectorRoute change:
- `OverlayNavHostRouteTest.kt` -- update `ThemeSelectorRoute` references to `ThemeSelectorRoute(isDark = true)`
- Any other test file referencing `ThemeSelectorRoute` as data object
  </action>
  <verify>
    <automated>cd android && ./gradlew :feature:settings:compileDebugKotlin :feature:dashboard:compileDebugKotlin --console=plain 2>&1 | tail -10</automated>
  </verify>
  <done>
    - AutoSwitchModeRoute added to OverlayRoutes.kt
    - ThemeSelectorRoute updated to data class with isDark param
    - OverlayNavHost wires AutoSwitchModeRoute to AutoSwitchModeContent in OverlayScaffold
    - onNavigateToThemeMode navigates to AutoSwitchModeRoute
    - Light/Dark Theme navigation rows added to MainSettings
    - MainSettings restructured to old codebase item order
    - About App banner with tagline, attribution, DQXN, version
    - SettingsItemRow with 40dp icon box, accentColor tint
    - Reset Dash row with red text
    - All string resources added
    - Source-varying transitions updated for AutoSwitchModeRoute
    - isDark from route passed to ThemeSelector
    - onCreateNewTheme wired to ThemeStudioRoute(null)
    - Compiles successfully
  </done>
</task>

<task type="auto">
  <name>Task 2: Update all tests for restructured MainSettings and route changes</name>
  <files>
    android/feature/settings/src/test/kotlin/app/dqxn/android/feature/settings/main/MainSettingsTest.kt
    android/feature/dashboard/src/test/kotlin/app/dqxn/android/feature/dashboard/layer/OverlayNavHostRouteTest.kt
  </files>
  <action>
**1. Update MainSettingsTest.kt renderMainSettings helper** to include all new params:
```kotlin
private fun renderMainSettings(
    analyticsConsent: Boolean = false,
    showStatusBar: Boolean = false,
    keepScreenOn: Boolean = true,
    lightThemeName: String = "Slate",
    darkThemeName: String = "Minimalist",
    packCount: Int = 3,
    themeCount: Int = 24,
    widgetCount: Int = 13,
    providerCount: Int = 9,
    autoSwitchModeDescription: String = "System",
    versionName: String = "1.0.0",
    onSetAnalyticsConsent: (Boolean) -> Unit = {},
    onSetShowStatusBar: (Boolean) -> Unit = {},
    onSetKeepScreenOn: (Boolean) -> Unit = {},
    onDeleteAllData: () -> Unit = {},
    onNavigateToThemeMode: () -> Unit = {},
    onNavigateToLightTheme: () -> Unit = {},
    onNavigateToDarkTheme: () -> Unit = {},
    onNavigateToDashPacks: () -> Unit = {},
    onNavigateToDiagnostics: () -> Unit = {},
    onResetDash: () -> Unit = {},
    onClose: () -> Unit = {},
)
```

**2. Update existing tests** that check section headers. The old tests verify "APPEARANCE", "BEHAVIOR", "DATA & PRIVACY", "DANGER ZONE" which no longer exist as primary sections. Replace:

```kotlin
@Test
fun `renders all 4 section headers`() { ... }
```
with:
```kotlin
@Test
fun `renders old codebase item order`() {
    renderMainSettings()

    // About banner first
    composeTestRule.onNodeWithTag("about_app_banner").assertExists()
    // Dash Packs
    composeTestRule.onNodeWithTag("main_settings_dash_packs").assertExists()
    // Theme items
    composeTestRule.onNodeWithTag("main_settings_theme_mode").assertExists()
    composeTestRule.onNodeWithTag("main_settings_light_theme").assertExists()
    composeTestRule.onNodeWithTag("main_settings_dark_theme").assertExists()
    // Status bar
    composeTestRule.onNodeWithTag("main_settings_status_bar").assertExists()
    // Reset dash
    scrollToTag("main_settings_reset_dash")
    composeTestRule.onNodeWithTag("main_settings_reset_dash").assertExists()
}
```

**3. Add new tests:**

```kotlin
@Test
fun `about app banner shows tagline`() {
    renderMainSettings()
    composeTestRule.onNodeWithText("Life is a dash. Make it beautiful.").assertExists()
}

@Test
fun `about app banner shows attribution`() {
    renderMainSettings()
    composeTestRule.onNodeWithText("-- The Dashing Dachshund").assertExists()
}

@Test
fun `about app banner shows app name and version`() {
    renderMainSettings(versionName = "1.0.0")
    composeTestRule.onNodeWithText("DQXN").assertExists()
    composeTestRule.onNodeWithText("1.0.0").assertExists()
}

@Test
fun `dash packs row shows dynamic count subtitle`() {
    renderMainSettings(packCount = 3, themeCount = 24, widgetCount = 13, providerCount = 9)
    composeTestRule.onNodeWithText("3 packs, 24 themes, 13 widgets, 9 providers").assertExists()
}

@Test
fun `theme mode row shows auto switch mode description`() {
    renderMainSettings(autoSwitchModeDescription = "System")
    composeTestRule.onNodeWithText("System").assertExists()
}

@Test
fun `light theme row shows current theme name`() {
    renderMainSettings(lightThemeName = "Slate")
    composeTestRule.onNodeWithText("Slate").assertExists()
}

@Test
fun `dark theme row shows current theme name`() {
    renderMainSettings(darkThemeName = "Minimalist")
    composeTestRule.onNodeWithText("Minimalist").assertExists()
}

@Test
fun `light theme row triggers navigation`() {
    var clicked = false
    renderMainSettings(onNavigateToLightTheme = { clicked = true })
    composeTestRule.onNodeWithTag("main_settings_light_theme").performClick()
    assertThat(clicked).isTrue()
}

@Test
fun `dark theme row triggers navigation`() {
    var clicked = false
    renderMainSettings(onNavigateToDarkTheme = { clicked = true })
    composeTestRule.onNodeWithTag("main_settings_dark_theme").performClick()
    assertThat(clicked).isTrue()
}

@Test
fun `status bar subtitle shown`() {
    renderMainSettings()
    composeTestRule.onNodeWithText("Applies to current dash").assertExists()
}

@Test
fun `reset dash row exists`() {
    renderMainSettings()
    scrollToTag("main_settings_reset_dash")
    composeTestRule.onNodeWithText("Reset Dash").assertExists()
    composeTestRule.onNodeWithText("Restore default layout and theme").assertExists()
}

@Test
fun `reset dash triggers callback`() {
    var resetCalled = false
    renderMainSettings(onResetDash = { resetCalled = true })
    scrollToTag("main_settings_reset_dash")
    composeTestRule.onNodeWithTag("main_settings_reset_dash").performClick()
    assertThat(resetCalled).isTrue()
}

@Test
fun `icon box styling verified in source`() {
    val file = File(System.getProperty("user.dir"),
        "feature/settings/src/main/kotlin/app/dqxn/android/feature/settings/main/MainSettings.kt")
    val content = file.readText()
    assertThat(content).contains("40.dp")
    assertThat(content).contains("accentColor.copy(alpha = 0.1f)")
    assertThat(content).contains("AboutAppBanner")
}
```

**4. Update OverlayNavHostRouteTest.kt** -- change `ThemeSelectorRoute` references to `ThemeSelectorRoute(isDark = true)`. Search and replace all occurrences. Also check for TalkBackAccessibilityTest.kt and FontScaleTest.kt if they reference MainSettings or ThemeSelectorRoute, and add new default params.

**5. Add import:**
```kotlin
import java.io.File
```
  </action>
  <verify>
    <automated>cd android && ./gradlew :feature:settings:testDebugUnitTest --tests "*.MainSettingsTest" :feature:dashboard:testDebugUnitTest --tests "*.OverlayNavHostRouteTest" --console=plain 2>&1 | tail -10</automated>
  </verify>
  <done>
    - MainSettingsTest helper updated with all new params
    - Old section header test replaced with item order test
    - About banner tests: tagline, attribution, app name, version
    - Dynamic subtitle tests: dash packs counts, theme mode, light/dark theme names
    - Navigation callback tests: light theme, dark theme
    - Status bar subtitle test
    - Reset dash test with callback
    - Icon box source verification
    - OverlayNavHostRouteTest updated for ThemeSelectorRoute(isDark)
    - All tests pass
  </done>
</task>

</tasks>

<verification>
1. `cd android && ./gradlew :feature:settings:compileDebugKotlin --console=plain` -- compiles
2. `cd android && ./gradlew :feature:dashboard:compileDebugKotlin --console=plain` -- compiles
3. `cd android && ./gradlew :feature:settings:testDebugUnitTest --tests "*.MainSettingsTest" --console=plain` -- all tests pass
4. `cd android && ./gradlew :feature:dashboard:testDebugUnitTest --tests "*.OverlayNavHostRouteTest" --console=plain` -- route tests pass
5. `cd android && ./gradlew :feature:dashboard:testDebugUnitTest --tests "*.OverlayNavHostTest" --console=plain` -- nav tests pass
6. `cd android && ./gradlew :feature:settings:testDebugUnitTest --console=plain` -- no regressions
</verification>

<success_criteria>
- MainSettings item order matches old codebase: About -> Dash Packs -> Themes -> Status Bar -> Reset Dash -> Advanced
- About App banner with tagline, attribution, DQXN, version
- Settings items have 40dp accent-tinted icon boxes
- Light/Dark Theme rows with current theme name subtitles
- Theme mode routing goes to AutoSwitchModeRoute
- ThemeSelectorRoute(isDark) passes isDark to ThemeSelector
- onCreateNewTheme wired in OverlayNavHost
- Reset Dash with red text and description
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/14-ui-visual-interactive-parity/14-09-SUMMARY.md`
</output>
